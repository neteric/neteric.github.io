<?xml version="1.0" encoding="utf-8"?>


<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title type="text">neteric</title>
    <subtitle type="html">neteric&#39;s blog, record work and life</subtitle>
    <updated>2022-10-16T13:14:11&#43;08:00</updated>
    <id>https://neteric.github.io/</id>
    <link rel="alternate" type="text/html" href="https://neteric.github.io/" />
    <link rel="self" type="application/atom&#43;xml" href="https://neteric.github.io/atom.xml" />
    <author>
            <name>neteric</name>
            <uri>https://neteric.github.io/</uri>
            
                <email>neteric@126.com</email>
            </author>
    <rights>[èœ€ICPå¤‡2022023345å·-1](http://beian.miit.gov.cn/)</rights>
    <generator uri="https://gohugo.io/" version="0.101.0">Hugo</generator>
        <entry>
            <title type="text">æ‰’ä¸€ä¸‹ElasticSearchåŸç†ï¼ˆä¸‰ï¼‰| åˆ†å¸ƒå¼ç‰¹æ€§</title>
            <link rel="alternate" type="text/html" href="https://neteric.github.io/posts/elasticsearch_principle_three/" />
            <id>https://neteric.github.io/posts/elasticsearch_principle_three/</id>
            <updated>2022-10-13T23:50:10&#43;08:00</updated>
            <published>2022-10-04T10:21:24&#43;08:00</published>
            <author>
                    <name>neteric</name>
                    <uri>https://blog.neteric.top/</uri>
                    <email>neteric@126.com</email>
                    </author>
            <rights>[èœ€ICPå¤‡2022023345å·-1](http://beian.miit.gov.cn/)</rights><summary type="html"></summary>
            
                <content type="html"></content>
            
            
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/categories/distribute-storge/" term="distribute storge" label="distribute storge" />
                            
                        
                    
                
                    
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/elasticsearch/" term="elasticsearch" label="elasticsearch" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/distribte-storage/" term="distribte storage" label="distribte storage" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/storage/" term="storage" label="storage" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">æ‰’ä¸€ä¸‹ElasticSearchåŸç†ï¼ˆäºŒï¼‰| æ•°æ®æŸ¥è¯¢</title>
            <link rel="alternate" type="text/html" href="https://neteric.github.io/posts/elasticsearch_principle_two/" />
            <id>https://neteric.github.io/posts/elasticsearch_principle_two/</id>
            <updated>2022-10-13T23:50:10&#43;08:00</updated>
            <published>2022-10-03T10:21:24&#43;08:00</published>
            <author>
                    <name>neteric</name>
                    <uri>https://blog.neteric.top/</uri>
                    <email>neteric@126.com</email>
                    </author>
            <rights>[èœ€ICPå¤‡2022023345å·-1](http://beian.miit.gov.cn/)</rights><summary type="html">ğŸ“Œ æ•°æ®æŸ¥è¯¢ æŸ¥è¯¢æ‰€æœ‰ æŸ¥è¯¢indexåä¸ºbankçš„æ•°æ®ï¼Œmatch_allè¡¨ç¤ºæŸ¥è¯¢æ‰€æœ‰çš„æ•°æ®ï¼Œsortå³æŒ‰ç…§ä»€ä¹ˆå­—æ®µæ’åº</summary>
            
                <content type="html">&lt;h3 id=&#34;-æ•°æ®æŸ¥è¯¢&#34;&gt;ğŸ“Œ æ•°æ®æŸ¥è¯¢&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æŸ¥è¯¢æ‰€æœ‰&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æŸ¥è¯¢indexåä¸ºbankçš„æ•°æ®ï¼Œ&lt;code&gt;match_all&lt;/code&gt;è¡¨ç¤ºæŸ¥è¯¢æ‰€æœ‰çš„æ•°æ®ï¼Œ&lt;code&gt;sort&lt;/code&gt;å³æŒ‰ç…§ä»€ä¹ˆå­—æ®µæ’åº&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;GET /bank/_search
{
  &amp;#34;query&amp;#34;: { &amp;#34;match_all&amp;#34;: {} },
  &amp;#34;sort&amp;#34;: [
    { &amp;#34;account_number&amp;#34;: &amp;#34;desc&amp;#34; }
  ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/elasticsearch_principle_one_bank_search_all.png&#34; alt=&#34;picture 23&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç›¸å…³å­—æ®µè§£é‡Šï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;  - took â€“ Elasticsearchè¿è¡ŒæŸ¥è¯¢æ‰€èŠ±è´¹çš„æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ 
  - timed_out â€“æœç´¢è¯·æ±‚æ˜¯å¦è¶…æ—¶ 
  - _shards - æœç´¢äº†å¤šå°‘ä¸ªåˆ†ç‰‡ï¼ŒæˆåŠŸã€å¤±è´¥æˆ–è·³è¿‡äº†å¤šå°‘ä¸ªåˆ†ç‰‡
  - max_score â€“ æ‰¾åˆ°çš„æœ€ç›¸å…³æ–‡æ¡£çš„åˆ†æ•° 
  - hits.total.value - æ‰¾åˆ°äº†å¤šå°‘ä¸ªåŒ¹é…çš„æ–‡æ¡£ 
  - hits._score - æ–‡æ¡£çš„ç›¸å…³æ€§å¾—åˆ†ï¼ˆä½¿ç”¨match_allæ—¶ä¸é€‚ç”¨ï¼‰
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†é¡µæŸ¥è¯¢&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»ç¬¬&lt;code&gt;3&lt;/code&gt;é¡µè®°å½•å¼€å§‹æŸ¥è¯¢ï¼Œæ¯é¡µ&lt;code&gt;5&lt;/code&gt;æ¡æ•°æ®,ä¸Sqlè¯­å¥ä¸­çš„offsetå’Œlimitç±»ä¼¼&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;GET /bank/_search
{
  &amp;#34;query&amp;#34;: { &amp;#34;match_all&amp;#34;: {} },
  &amp;#34;sort&amp;#34;: [
    { &amp;#34;account_number&amp;#34;: &amp;#34;asc&amp;#34; }
  ],
  &amp;#34;from&amp;#34;: 10,
  &amp;#34;size&amp;#34;: 5
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æŒ‡å®šå­—æ®µæŸ¥è¯¢&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;GET /bank/_search
{
  &amp;#34;query&amp;#34;: { &amp;#34;match&amp;#34;: { &amp;#34;address&amp;#34;: &amp;#34;mill lane&amp;#34; } }
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šæ¡ä»¶æŸ¥è¯¢&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/elasticsearch_principle_one_search_by_field.png&#34; alt=&#34;picture 24&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;èšåˆæŸ¥è¯¢ï¼ˆAggregationï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨SQLä¸­æœ‰group byï¼Œåœ¨ESä¸­å®ƒå«Aggregationï¼Œå³èšåˆè¿ç®—&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</content>
            
            
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/categories/distribute-storge/" term="distribute storge" label="distribute storge" />
                            
                        
                    
                
                    
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/elasticsearch/" term="elasticsearch" label="elasticsearch" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/distribte-storage/" term="distribte storage" label="distribte storage" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/storage/" term="storage" label="storage" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">æ‰’ä¸€ä¸‹ElasticSearchåŸç†ï¼ˆä¸€ï¼‰| ç´¢å¼•ç®¡ç†</title>
            <link rel="alternate" type="text/html" href="https://neteric.github.io/posts/elasticsearch_principle_one/" />
            <id>https://neteric.github.io/posts/elasticsearch_principle_one/</id>
            <updated>2022-10-15T23:39:14&#43;08:00</updated>
            <published>2022-10-02T10:21:24&#43;08:00</published>
            <author>
                    <name>neteric</name>
                    <uri>https://blog.neteric.top/</uri>
                    <email>neteric@126.com</email>
                    </author>
            <rights>[èœ€ICPå¤‡2022023345å·-1](http://beian.miit.gov.cn/)</rights><summary type="html">ç´¢å¼•ç®¡ç† ğŸ“Œ ç´¢å¼•ä»‹ç» åˆ›å»ºç´¢å¼• åˆ›å»ºåå­—ä¸ºproductçš„ç´¢å¼•ï¼Œå¹¶æŒ‡å®šidä¸º1çš„æ–‡æ¡£çš„å†…å®¹</summary>
            
                <content type="html">&lt;h2 id=&#34;ç´¢å¼•ç®¡ç†-&#34;&gt;ç´¢å¼•ç®¡ç† ğŸ“Œ&lt;/h2&gt;
&lt;h3 id=&#34;ç´¢å¼•ä»‹ç»&#34;&gt;ç´¢å¼•ä»‹ç»&lt;/h3&gt;
&lt;h3 id=&#34;åˆ›å»ºç´¢å¼•&#34;&gt;åˆ›å»ºç´¢å¼•&lt;/h3&gt;
&lt;p&gt;åˆ›å»ºåå­—ä¸º&lt;code&gt;product&lt;/code&gt;çš„ç´¢å¼•ï¼Œå¹¶æŒ‡å®šidä¸º1çš„æ–‡æ¡£çš„å†…å®¹&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;PUT /product/_doc/1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;computer&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/elasticsearch_principle_one_create_index.png&#34; alt=&#34;create_index&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä¿®æ”¹ç´¢å¼•&#34;&gt;ä¿®æ”¹ç´¢å¼•&lt;/h3&gt;
&lt;h3 id=&#34;æ‰“å¼€å…³é—­ç´¢å¼•&#34;&gt;æ‰“å¼€/å…³é—­ç´¢å¼•&lt;/h3&gt;
&lt;h3 id=&#34;åˆ é™¤ç´¢å¼•&#34;&gt;åˆ é™¤ç´¢å¼•&lt;/h3&gt;
&lt;h3 id=&#34;æŸ¥çœ‹ç´¢å¼•&#34;&gt;æŸ¥çœ‹ç´¢å¼•&lt;/h3&gt;
&lt;h3 id=&#34;æ‰¹é‡ç´¢å¼•æ–‡æ¡£&#34;&gt;æ‰¹é‡ç´¢å¼•æ–‡æ¡£&lt;/h3&gt;
&lt;p&gt;åœ¨æºç ä¸­æ‰¾åˆ°æµ‹è¯•æ•°æ®å¹¶ä¸‹è½½&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl https://github.com/elastic/elasticsearch/blob/v6.8.19/docs/src/test/resources/accounts.json
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å°†ä¸‹è½½åˆ°çš„accounts.jsonæ–‡ä»¶æ‰¹é‡å¯¼å…¥åˆ°EleasticSearchä¸­&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl -H &amp;#34;Content-Type: application/json&amp;#34; -XPOST &amp;#34;username:password@localhost:9200/bank/_bulk?pretty&amp;amp;refresh&amp;#34; --data-binary &amp;#34;@./accounts.json&amp;#34;
&lt;/code&gt;&lt;/pre&gt;</content>
            
            
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/categories/distribute-storge/" term="distribute storge" label="distribute storge" />
                            
                        
                    
                
                    
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/elasticsearch/" term="elasticsearch" label="elasticsearch" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/distribte-storage/" term="distribte storage" label="distribte storage" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/storage/" term="storage" label="storage" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">å­˜å‚¨å¼•æ“å¯¹æ¯”</title>
            <link rel="alternate" type="text/html" href="https://neteric.github.io/posts/storage-engine-compare/" />
            <id>https://neteric.github.io/posts/storage-engine-compare/</id>
            <updated>2022-10-16T12:28:41&#43;08:00</updated>
            <published>2022-08-18T16:10:03&#43;08:00</published>
            <author>
                    <name>neteric</name>
                    <uri>https://blog.neteric.top/</uri>
                    <email>neteric@126.com</email>
                    </author>
            <rights>[èœ€ICPå¤‡2022023345å·-1](http://beian.miit.gov.cn/)</rights><summary type="html">å­˜å‚¨å¼•æ“å¯¹æ¯”</summary>
            
                <content type="html">&lt;h2 id=&#34;èƒŒæ™¯&#34;&gt;èƒŒæ™¯&lt;/h2&gt;
&lt;h3 id=&#34;ç¡¬ç›˜ç»“æ„&#34;&gt;ç¡¬ç›˜ç»“æ„&lt;/h3&gt;
&lt;p&gt;ç¡¬ç›˜å†…éƒ¨ä¸»è¦éƒ¨ä»¶ä¸ºç£ç›˜ç›˜ç‰‡ã€ä¼ åŠ¨æ‰‹è‡‚ã€è¯»å†™ç£å¤´å’Œä¸»è½´é©¬è¾¾ã€‚å®é™…æ•°æ®éƒ½æ˜¯å†™åœ¨ç›˜ç‰‡ä¸Šï¼Œè¯»å†™ä¸»è¦æ˜¯é€šè¿‡ä¼ åŠ¨æ‰‹è‡‚ä¸Šçš„è¯»å†™ç£å¤´æ¥å®Œæˆã€‚å®é™…è¿è¡Œæ—¶ï¼Œä¸»è½´è®©ç£ç›˜ç›˜ç‰‡è½¬åŠ¨ï¼Œç„¶åä¼ åŠ¨æ‰‹è‡‚å¯ä¼¸å±•è®©è¯»å–å¤´åœ¨ç›˜ç‰‡ä¸Šè¿›è¡Œè¯»å†™æ“ä½œã€‚ç£ç›˜ç‰©ç†ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://info.mrtlab.com/uploadfile/201305/14/104000249.JPG&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç”±äºå•ä¸€ç›˜ç‰‡å®¹é‡æœ‰é™ï¼Œä¸€èˆ¬ç¡¬ç›˜éƒ½æœ‰ä¸¤å¼ ä»¥ä¸Šçš„ç›˜ç‰‡ï¼Œæ¯ä¸ªç›˜ç‰‡æœ‰ä¸¤é¢ï¼Œéƒ½å¯è®°å½•ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸€å¼ ç›˜ç‰‡å¯¹åº”ç€ä¸¤ä¸ªç£å¤´ã€‚ç›˜ç‰‡è¢«åˆ†ä¸ºè®¸å¤šæ‰‡å½¢çš„åŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸå«ä¸€ä¸ªæ‰‡åŒºï¼Œç¡¬ç›˜ä¸­æ¯ä¸ªæ‰‡åŒºçš„å¤§å°å›ºå®šä¸º512å­—èŠ‚ã€‚ç›˜ç‰‡è¡¨é¢ä¸Šä»¥ç›˜ç‰‡ä¸­å¿ƒä¸ºåœ†å¿ƒï¼Œä¸åŒåŠå¾„çš„åŒå¿ƒåœ†ç§°ä¸ºç£é“ï¼Œä¸åŒç›˜ç‰‡ç›¸åŒåŠå¾„çš„ç£é“æ‰€ç»„æˆçš„åœ†æŸ±ç§°ä¸ºæŸ±é¢ã€‚ç£é“ä¸æŸ±é¢éƒ½æ˜¯è¡¨ç¤ºä¸åŒåŠå¾„çš„åœ†ï¼Œåœ¨è®¸å¤šåœºåˆï¼Œç£é“å’ŒæŸ±é¢å¯ä»¥äº’æ¢ä½¿ç”¨ã€‚ç£ç›˜ç›˜ç‰‡å‚ç›´è§†è§’å¦‚ä¸‹å›¾æ‰€ç¤º&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://info.mrtlab.com/uploadfile/201305/14/1040344565.jpg&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å½±å“ç¡¬ç›˜æ€§èƒ½çš„å› ç´ &#34;&gt;å½±å“ç¡¬ç›˜æ€§èƒ½çš„å› ç´ &lt;/h3&gt;
&lt;p&gt;å½±å“ç£ç›˜çš„å…³é”®å› ç´ æ˜¯ç£ç›˜æœåŠ¡æ—¶é—´ï¼Œå³ç£ç›˜å®Œæˆä¸€ä¸ªI/Oè¯·æ±‚æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå®ƒç”±å¯»é“æ—¶é—´ã€æ—‹è½¬å»¶è¿Ÿå’Œæ•°æ®ä¼ è¾“æ—¶é—´ä¸‰éƒ¨åˆ†æ„æˆã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯»é“æ—¶é—´&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Tseekæ˜¯æŒ‡å°†è¯»å†™ç£å¤´ç§»åŠ¨è‡³æ­£ç¡®çš„ç£é“ä¸Šæ‰€éœ€è¦çš„æ—¶é—´ã€‚å¯»é“æ—¶é—´è¶ŠçŸ­ï¼ŒI/Oæ“ä½œè¶Šå¿«ï¼Œç›®å‰ç£ç›˜çš„å¹³å‡å¯»é“æ—¶é—´ä¸€èˆ¬åœ¨3-15msã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ—‹è½¬å»¶è¿Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Trotationæ˜¯æŒ‡ç›˜ç‰‡æ—‹è½¬å°†è¯·æ±‚æ•°æ®æ‰€åœ¨çš„æ‰‡åŒºç§»åŠ¨åˆ°è¯»å†™ç£ç›˜ä¸‹æ–¹æ‰€éœ€è¦çš„æ—¶é—´ã€‚æ—‹è½¬å»¶è¿Ÿå–å†³äºç£ç›˜è½¬é€Ÿï¼Œé€šå¸¸ç”¨ç£ç›˜æ—‹è½¬ä¸€å‘¨æ‰€éœ€æ—¶é—´çš„1/2è¡¨ç¤ºã€‚æ¯”å¦‚ï¼š7200rpmçš„ç£ç›˜å¹³å‡æ—‹è½¬å»¶è¿Ÿå¤§çº¦ä¸º60*1000/7200/2 = 4.17msï¼Œè€Œè½¬é€Ÿä¸º15000rpmçš„ç£ç›˜å…¶å¹³å‡æ—‹è½¬å»¶è¿Ÿä¸º2msã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®ä¼ è¾“æ—¶é—´&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ttransferæ˜¯æŒ‡å®Œæˆä¼ è¾“æ‰€è¯·æ±‚çš„æ•°æ®æ‰€éœ€è¦çš„æ—¶é—´ï¼Œå®ƒå–å†³äºæ•°æ®ä¼ è¾“ç‡ï¼Œå…¶å€¼ç­‰äºæ•°æ®å¤§å°é™¤ä»¥æ•°æ®ä¼ è¾“ç‡ã€‚ç›®å‰IDE/ATAèƒ½è¾¾åˆ°133MB/sï¼ŒSATA IIå¯è¾¾åˆ°300MB/sçš„æ¥å£æ•°æ®ä¼ è¾“ç‡ï¼Œæ•°æ®ä¼ è¾“æ—¶é—´é€šå¸¸è¿œå°äºå‰ä¸¤éƒ¨åˆ†æ¶ˆè€—æ—¶é—´ã€‚ç®€å•è®¡ç®—æ—¶å¯å¿½ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;ç»“è®ºï¼š**æœºæ¢°ç¡¬ç›˜çš„è¿ç»­è¯»å†™æ€§èƒ½å¾ˆå¥½ï¼Œä½†éšæœºè¯»å†™æ€§èƒ½å¾ˆå·®ï¼Œ**è¿™ä¸»è¦æ˜¯å› ä¸ºç£å¤´ç§»åŠ¨åˆ°æ­£ç¡®çš„ç£é“ä¸Šéœ€è¦æ—¶é—´ï¼Œéšæœºè¯»å†™æ—¶ï¼Œç£å¤´éœ€è¦ä¸åœçš„ç§»åŠ¨ï¼Œæ—¶é—´éƒ½æµªè´¹åœ¨äº†ç£å¤´å¯»å€ä¸Šï¼Œæ‰€ä»¥æ€§èƒ½ä¸é«˜&lt;/p&gt;
&lt;h3 id=&#34;linux-ioæµç¨‹&#34;&gt;Linux IOæµç¨‹&lt;/h3&gt;
&lt;p&gt;ç±»ä¼¼äºç½‘ç»œçš„åˆ†å±‚ç»“æ„ï¼Œä¸‹å›¾æ˜¾ç¤ºäº†Linuxç³»ç»Ÿä¸­å¯¹äºç£ç›˜çš„ä¸€æ¬¡è¯»è¯·æ±‚åœ¨æ ¸å¿ƒç©ºé—´ä¸­æ‰€è¦ç»å†çš„å±‚æ¬¡æ¨¡å‹ã€‚ä»å›¾ä¸­çœ‹å‡ºï¼šå¯¹äºç£ç›˜çš„ä¸€æ¬¡è¯»è¯·æ±‚ï¼Œé¦–å…ˆç»è¿‡è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿå±‚ï¼ˆVFS Layerï¼‰ï¼Œå…¶æ¬¡æ˜¯å…·ä½“çš„æ–‡ä»¶ç³»ç»Ÿå±‚ï¼ˆä¾‹å¦‚Ext2ï¼‰ï¼Œæ¥ä¸‹æ¥æ˜¯Cacheå±‚ï¼ˆPage Cache Layerï¼‰ã€é€šç”¨å—å±‚ï¼ˆGeneric Block Layerï¼‰ã€I/Oè°ƒåº¦å±‚ï¼ˆI/O Scheduler Layerï¼‰ã€å—è®¾å¤‡é©±åŠ¨å±‚ï¼ˆBlock Device Driver Layerï¼‰ï¼Œæœ€åæ˜¯ç‰©ç†å—è®¾å¤‡å±‚ï¼ˆBlock Device Layerï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/storage_engine_compare/fig01.png&#34; alt=&#34;image-20220819105617539&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.thomas-krenn.com/de/wikiDE/images/e/e0/Linux-storage-stack-diagram_v4.10.png&#34;&gt;kernel 4.10 linux io stack&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»“è®ºï¼š &lt;strong&gt;ä¸€æ¬¡ç¡¬ç›˜è¯»å–IOè·¯å¾„éå¸¸é•¿ï¼Œè¦ç»å†ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒIOè°ƒåº¦ï¼Œå—è®¾å¤‡é©±åŠ¨ï¼Œä¸­æ–­ç­‰é€»è¾‘&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;å­˜å‚¨åˆ†ç±»&#34;&gt;å­˜å‚¨åˆ†ç±»&lt;/h3&gt;
&lt;h4 id=&#34;ç»“æ„åŒ–æ•°æ®&#34;&gt;ç»“æ„åŒ–æ•°æ®&lt;/h4&gt;
&lt;p&gt;å¯ä»¥ä»åç§°ä¸­çœ‹å‡ºï¼Œæ˜¯é«˜åº¦ç»„ç»‡å’Œæ•´é½æ ¼å¼åŒ–çš„æ•°æ®ã€‚ç»“æ„åŒ–æ•°æ®å¯ä»¥è½»æ˜“æ”¾å…¥è¡¨æ ¼å’Œç”µå­è¡¨æ ¼ä¸­çš„æ•°æ®ç±»å‹ï¼Œå…¸å‹çš„æ¯”å¦‚ä½¿ç”¨å…³ç³»å‹æ•°æ®åº“è¡¨ç¤ºå’Œå­˜å‚¨ï¼Œè¡¨ç°ä¸ºäºŒç»´å½¢å¼çš„æ•°æ®ã€‚ä¸€èˆ¬ç‰¹ç‚¹æ˜¯ï¼šæ•°æ®ä»¥è¡Œä¸ºå•ä½ï¼Œä¸€è¡Œæ•°æ®è¡¨ç¤ºä¸€ä¸ªå®ä½“çš„ä¿¡æ¯ï¼Œæ¯ä¸€è¡Œæ•°æ®çš„å±æ€§æ˜¯ç›¸åŒçš„&lt;/p&gt;
&lt;h5 id=&#34;ç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨&#34;&gt;ç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;å…³ç³»å‹æ•°æ®åº“ï¼šå¦‚ MySQLã€PostreSQLã€Oracleã€SQLServerï¼Œ å…¶ç»„æˆä¸€èˆ¬åŒ…æ‹¬ï¼š è¿æ¥å™¨ï¼Œè§£æå™¨ï¼Œä¼˜åŒ–å™¨ï¼Œæ‰§è¡Œå™¨ï¼Œ&lt;strong&gt;å­˜å‚¨å¼•æ“&lt;/strong&gt;ï¼Œ ç®¡ç†ç¡¬ç›˜çš„å•æœºæ–‡ä»¶ç³»ç»Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;åŠç»“æ„åŒ–æ•°æ®&#34;&gt;åŠç»“æ„åŒ–æ•°æ®&lt;/h4&gt;
&lt;p&gt;åŠç»“æ„åŒ–æ•°æ®æ˜¯ç»“æ„åŒ–æ•°æ®çš„ä¸€ç§å½¢å¼ï¼Œå®ƒå¹¶ä¸ç¬¦åˆå…³ç³»å‹æ•°æ®åº“æˆ–å…¶ä»–æ•°æ®è¡¨çš„å½¢å¼å…³è”èµ·æ¥çš„æ•°æ®æ¨¡å‹ç»“æ„ï¼Œä½†åŒ…å«ç›¸å…³æ ‡è®°ï¼Œç”¨æ¥åˆ†éš”è¯­ä¹‰å…ƒç´ ä»¥åŠå¯¹è®°å½•å’Œå­—æ®µè¿›è¡Œåˆ†å±‚ã€‚å› æ­¤ï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºè‡ªæè¿°çš„ç»“æ„ã€‚å¸¸è§çš„åŠç»“æ„æ•°æ®æ ¼å¼æœ‰XMLã€JSONã€Yaml&lt;/p&gt;
&lt;h5 id=&#34;åŠç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨&#34;&gt;åŠç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;K/Vå­˜å‚¨ï¼šRocksdbã€LevelDBã€BlotDB å…¶ç»„æˆä¸€èˆ¬åŒ…æ‹¬ï¼šè¿æ¥å™¨ï¼Œä¼˜åŒ–å™¨ï¼Œ&lt;strong&gt;å­˜å‚¨å¼•æ“&lt;/strong&gt;ï¼Œå•æœºæ–‡ä»¶ç³»ç»Ÿ&lt;/li&gt;
&lt;li&gt;æ–‡æ¡£å­˜å‚¨ï¼š MongoDBã€ElasticSearch&lt;/li&gt;
&lt;li&gt;åˆ—å¼å­˜å‚¨ï¼ˆä¹Ÿå«è¡¨æ ¼å­˜å‚¨ï¼‰ï¼š ClickHouseã€Apache Druid ã€Hbase&lt;/li&gt;
&lt;li&gt;å†…å­˜K/Vå­˜å‚¨ï¼š Redisã€Memcache&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;éç»“æ„åŒ–æ•°æ®&#34;&gt;éç»“æ„åŒ–æ•°æ®&lt;/h4&gt;
&lt;p&gt;æ•°æ®ç»“æ„ä¸è§„åˆ™æˆ–ä¸å®Œæ•´ï¼Œæ²¡æœ‰é¢„å®šä¹‰çš„æ•°æ®æ¨¡å‹ï¼Œä¸æ–¹ä¾¿ç”¨æ•°æ®åº“äºŒç»´é€»è¾‘è¡¨æ¥è¡¨ç°çš„æ•°æ®ã€‚æœ¬è´¨ä¸Šæ˜¯ç»“æ„åŒ–æ•°æ®ä¹‹å¤–çš„ä¸€åˆ‡æ•°æ®ï¼Œå¦‚ï¼šå…¨æ–‡æ–‡æœ¬ã€å›¾ç‰‡ã€éŸ³é¢‘ã€å½±è§†ã€è¶…åª’ä½“ç­‰ä¿¡æ¯&lt;/p&gt;
&lt;h5 id=&#34;éç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨&#34;&gt;éç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å•æœºæ–‡ä»¶ç³»ç»Ÿï¼š å¦‚ ext2/3/4, xfs, btrfs, bluefs,ntfs, fat32&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ†å¸ƒå¼å—/å¯¹è±¡/æ–‡ä»¶å­˜å‚¨ï¼šå¦‚ ceph, hdfs, glusterfs, MinIOï¼Œè¿™ç±»éç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨åˆå«Blobå­˜å‚¨ï¼Œå…¶ç»„æˆéƒ¨åˆ†ä¸€èˆ¬éƒ½åŒ…æ‹¬ï¼šç®¡ç†ç¡¬ç›˜çš„å•æœºæ–‡ä»¶ç³»ç»Ÿ ï¼Œåˆ†å¸ƒå¼ç‰¹æ€§çš„å®ç°ï¼ˆåˆ†ç‰‡ï¼Œå¤åˆ¶ï¼Œä¸€è‡´æ€§ï¼‰ï¼Œå…ƒæ•°æ®ç®¡ç†ç³»ç»Ÿï¼ˆå…ƒæ•°æ®ä¸€èˆ¬éƒ½æ˜¯åŠç»“æ„åŒ–æ•°æ®ï¼‰ï¼Œæ¥å£å®ç°ï¼ˆå—ï¼Œå¯¹è±¡ï¼Œæ–‡ä»¶ï¼‰å¯å‚è€ƒå‰é¢çš„æŠ€æœ¯åˆ†äº«ï¼š&lt;a href=&#34;https://duodian.feishu.cn/file/boxcnPObkzRjzgF1mfrwJnzbMPc&#34;&gt;https://duodian.feishu.cn/file/boxcnPObkzRjzgF1mfrwJnzbMPc&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å­˜å‚¨ä½¿ç”¨åœºæ™¯&#34;&gt;å­˜å‚¨ä½¿ç”¨åœºæ™¯&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å±æ€§&lt;/th&gt;
&lt;th&gt;OLTP&lt;/th&gt;
&lt;th&gt;OLAP&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ä¸»è¦è¯»å–æ¨¡å¼&lt;/td&gt;
&lt;td&gt;å°æ•°æ®é‡çš„éšæœºè¯»ï¼Œé€šè¿‡ key æŸ¥è¯¢&lt;/td&gt;
&lt;td&gt;å¤§æ•°æ®é‡çš„èšåˆï¼ˆmax,min,sum, avgï¼‰æŸ¥è¯¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸»è¦å†™å…¥æ¨¡å¼&lt;/td&gt;
&lt;td&gt;éšæœºè®¿é—®ï¼Œä½å»¶è¿Ÿå†™å…¥&lt;/td&gt;
&lt;td&gt;æ‰¹é‡å¯¼å…¥ï¼ˆETLï¼‰æˆ–è€…æµå¼å†™å…¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸»è¦åº”ç”¨åœºæ™¯&lt;/td&gt;
&lt;td&gt;é€šè¿‡ web æ–¹å¼ä½¿ç”¨çš„æœ€ç»ˆç”¨æˆ·&lt;/td&gt;
&lt;td&gt;äº’è”ç½‘åˆ†æï¼Œä¸ºäº†è¾…åŠ©å†³ç­–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¦‚ä½•çœ‹å¾…æ•°æ®&lt;/td&gt;
&lt;td&gt;å½“å‰æ—¶é—´ç‚¹çš„æœ€æ–°çŠ¶æ€&lt;/td&gt;
&lt;td&gt;éšç€æ—¶é—´æ¨ç§»çš„&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ•°æ®é‡&lt;/td&gt;
&lt;td&gt;å•æ¬¡æŸ¥è¯¢å’Œæ€»ä½“éƒ½ç›¸å¯¹è¾ƒå°ï¼Œæ€»ä½“é€šå¸¸ GB åˆ° TB&lt;/td&gt;
&lt;td&gt;å•æ¬¡æŸ¥è¯¢å’Œæ€»ä½“éƒ½ç›¸å¯¹å·¨å¤§ï¼Œæ€»ä½“é€šå¸¸ TB åˆ° PB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¯·æ±‚æ•°é‡&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹é¢‘ç¹ï¼Œä¾§é‡åœ¨çº¿äº¤æ˜“&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹è¾ƒå°‘ï¼Œä¾§é‡ç¦»çº¿åˆ†æ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç“¶é¢ˆ&lt;/td&gt;
&lt;td&gt;Disk Seek&lt;/td&gt;
&lt;td&gt;Disk Bandwidth&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å­˜å‚¨æ ¼å¼&lt;/td&gt;
&lt;td&gt;å¤šç”¨è¡Œå­˜&lt;/td&gt;
&lt;td&gt;åˆ—å­˜é€æ¸æµè¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç”¨æˆ·&lt;/td&gt;
&lt;td&gt;æ¯”è¾ƒæ™®éï¼Œä¸€èˆ¬åº”ç”¨ç”¨çš„æ¯”è¾ƒå¤š&lt;/td&gt;
&lt;td&gt;å¤šä¸ºå•†ä¸šç”¨æˆ·&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åœºæ™¯ä¸¾ä¾‹&lt;/td&gt;
&lt;td&gt;é“¶è¡Œäº¤æ˜“&lt;/td&gt;
&lt;td&gt;å•†ä¸šåˆ†æ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;äº§å“ä¸¾ä¾‹&lt;/td&gt;
&lt;td&gt;MySQL&lt;/td&gt;
&lt;td&gt;ClickHouse&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;lsm-treeçš„èµ·æº&#34;&gt;LSM Treeçš„èµ·æº&lt;/h2&gt;
&lt;h3 id=&#34;ä¸–ç•Œä¸Šæœ€ç®€å•çš„æ•°æ®åº“&#34;&gt;ä¸–ç•Œä¸Šæœ€ç®€å•çš„æ•°æ®åº“&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆæ¥çœ‹ï¼Œä¸–ç•Œä¸Šâ€œæœ€ç®€å•â€çš„æ•°æ®åº“ï¼Œç”±ä¸¤ä¸ª Bash å‡½æ•°æ„æˆï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;db_set &lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$1&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$2&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; database
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;db_get &lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; grep &lt;span class=&#34;s2&#34;&gt;&amp;#34;^&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$1&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;,&amp;#34;&lt;/span&gt; database &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; sed -e &lt;span class=&#34;s2&#34;&gt;&amp;#34;s/^&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$1&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;,//&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tail -n &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸¤ä¸ªå‡½æ•°å®ç°äº†ä¸€ä¸ªåŸºäºå­—ç¬¦ä¸²çš„ KV å­˜å‚¨ï¼ˆåªæ”¯æŒ get/setï¼Œä¸æ”¯æŒ deleteï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ db_set &lt;span class=&#34;m&#34;&gt;123456&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;name&amp;#34;:&amp;#34;London&amp;#34;,&amp;#34;attractions&amp;#34;:[&amp;#34;BigBen&amp;#34;,&amp;#34;LondonEye&amp;#34;]}&amp;#39;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ db_set &lt;span class=&#34;m&#34;&gt;42&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;name&amp;#34;:&amp;#34;SanFrancisco&amp;#34;,&amp;#34;attractions&amp;#34;:[&amp;#34;GoldenGateBridge&amp;#34;]}&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ db_get &lt;span class=&#34;m&#34;&gt;42&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;:&lt;span class=&#34;s2&#34;&gt;&amp;#34;San Francisco&amp;#34;&lt;/span&gt;,&lt;span class=&#34;s2&#34;&gt;&amp;#34;attractions&amp;#34;&lt;/span&gt;:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Golden Gate Bridge&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ¥åˆ†æä¸‹å®ƒä¸ºä»€ä¹ˆ workï¼Œä¹Ÿåæ˜ äº†æ—¥å¿—ç»“æ„å­˜å‚¨çš„æœ€åŸºæœ¬åŸç†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;setï¼šåœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä¸€ä¸ª KV å¯¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;getï¼šåŒ¹é…æ‰€æœ‰ Keyï¼Œè¿”å›æœ€åï¼ˆä¹Ÿå³æœ€æ–°ï¼‰ä¸€æ¡ KV å¯¹ä¸­çš„ Value&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ›´æ–°æ“ä½œï¼š ä½¿ç”¨setåœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä¸€æ¡è¯¥keyçš„æ–°è®°å½•&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ é™¤æ“ä½œï¼š ä½¿ç”¨setåœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä¸€æ¡è¯¥keyçš„å¢“ç¢‘è®°å½•ï¼Œå½“æŸ¥è¯¢åˆ°å¢“ç¢‘è®°å½•ä»£è¡¨è¿™ä¸ªkeyå·²åˆ é™¤&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;å¼•å…¥å“ˆå¸Œç´¢å¼•&#34;&gt;å¼•å…¥å“ˆå¸Œç´¢å¼•&lt;/h3&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œä¸Šè¿°â€œä¸–ç•Œä¸Šæœ€ç®€å•çš„æ•°æ®åº“â€å†™å…¥çš„é€Ÿåº¦éå¸¸å¿«ï¼Œå‡ ä¹æ˜¯æ•°æ®åº“èƒ½åšåˆ°çš„æé™ã€‚ä½†æ˜¯è¯»éœ€è¦å…¨æ–‡é€è¡Œæ‰«æï¼Œä¼šæ…¢å¾ˆå¤šï¼Œå¦‚æœæ•°æ®é‡è¾¾åˆ°ç™¾GBçº§åˆ«ï¼Œè¯¥æ•°æ®åº“çš„è¯»å˜å¾—å‡ ä¹ä¸å¯ç”¨ï¼Œä¸ºäº†åŠ å¿«è¯»ï¼Œæˆ‘ä»¬éœ€è¦æ„å»º&lt;strong&gt;ç´¢å¼•&lt;/strong&gt;ï¼ˆä¸€ç§å…è®¸åŸºäºæŸäº›å­—æ®µæŸ¥æ‰¾çš„é¢å¤–æ•°æ®ç»“æ„ï¼‰&lt;/p&gt;
&lt;p&gt;ç´¢å¼•ä»åŸæ•°æ®ä¸­æ„å»ºï¼Œåªä¸ºåŠ å¿«æŸ¥æ‰¾ã€‚å› æ­¤ç´¢å¼•ä¼šè€—è´¹ä¸€å®šé¢å¤–ç©ºé—´ï¼Œå’Œæ’å…¥æ—¶é—´ï¼ˆæ¯æ¬¡æ’å…¥è¦æ›´æ–°ç´¢å¼•ï¼‰ï¼Œå³ï¼Œé‡æ–°ä»¥ç©ºé—´å’Œå†™æ¢è¯»å–ã€‚&lt;/p&gt;
&lt;p&gt;ä¾ä¸Šå°èŠ‚çš„ä¾‹å­ï¼Œæ‰€æœ‰æ•°æ®é¡ºåºè¿½åŠ åˆ°ç£ç›˜ä¸Šã€‚ä¸ºäº†åŠ å¿«æŸ¥è¯¢ï¼Œæˆ‘ä»¬åœ¨å†…å­˜ä¸­æ„å»ºä¸€ä¸ªå“ˆå¸Œç´¢å¼•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Key æ˜¯æŸ¥è¯¢ Key&lt;/li&gt;
&lt;li&gt;Value æ˜¯ KV æ¡ç›®çš„èµ·å§‹ä½ç½®å’Œé•¿åº¦ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/ch03-fig01.png&#34; alt=&#34;ddia-3-1-hash-map-csv.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†è¿™æ­£æ˜¯ &lt;a href=&#34;https://docs.riak.com/riak/kv/2.2.3/setup/planning/backend/bitcask/index.html&#34; title=&#34;Bitcask&#34;&gt;Bitcask&lt;/a&gt; çš„åŸºæœ¬è®¾è®¡ï¼Œå…³é”®æ˜¯ä»–èƒ½å¾ˆå¥½çš„ Workï¼ˆåœ¨å°æ•°æ®é‡æ—¶ï¼Œå³æ‰€æœ‰ key éƒ½èƒ½å­˜åˆ°å†…å­˜ä¸­æ—¶ï¼‰èƒ½æä¾›å¾ˆé«˜çš„è¯»å†™æ€§èƒ½&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å†™ï¼šæ–‡ä»¶è¿½åŠ å†™ã€‚&lt;/li&gt;
&lt;li&gt;è¯»ï¼šä¸€æ¬¡å†…å­˜æŸ¥è¯¢ï¼Œä¸€æ¬¡ç£ç›˜ seekï¼›å¦‚æœæ•°æ®å·²ç»è¢«ç¼“å­˜ï¼Œåˆ™ seek ä¹Ÿå¯ä»¥çœæ‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœä½ çš„ key é›†åˆå¾ˆå°ï¼ˆæ„å‘³ç€èƒ½å…¨æ”¾å†…å­˜ï¼‰ï¼Œä½†æ˜¯æ¯ä¸ª key æ›´æ–°å¾ˆé¢‘ç¹ï¼Œé‚£ä¹ˆ Bitcask ä¾¿æ˜¯ä½ çš„èœã€‚ä¸¾ä¸ªæ —å­ï¼šé¢‘ç¹æ›´æ–°çš„è§†é¢‘æ’­æ”¾é‡ï¼Œkey æ˜¯è§†é¢‘ urlï¼Œvalue æ˜¯è§†é¢‘æ’­æ”¾é‡&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½†æœ‰ä¸ªå¾ˆé‡è¦é—®é¢˜ï¼Œå•ä¸ªæ–‡ä»¶è¶Šæ¥è¶Šå¤§ï¼Œç£ç›˜ç©ºé—´ä¸å¤Ÿæ€ä¹ˆåŠï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨æ–‡ä»¶åˆ°è¾¾ä¸€å®šå°ºå¯¸åï¼Œå°±æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå°†åŸæ–‡ä»¶å˜ä¸ºåªè¯»ã€‚åŒæ—¶ä¸ºäº†å›æ”¶å¤šä¸ª key å¤šæ¬¡å†™å…¥çš„é€ æˆçš„ç©ºé—´æµªè´¹ï¼Œå¯ä»¥å°†åªè¯»æ–‡ä»¶è¿›è¡Œç´§ç¼©ï¼ˆ compact ï¼‰ï¼Œå°†æ—§æ–‡ä»¶è¿›è¡Œé‡å†™ï¼ŒæŒ¤å‡ºâ€œæ°´åˆ†â€ï¼ˆè¢«è¦†å†™çš„æ•°æ®ï¼‰ä»¥è¿›è¡Œåƒåœ¾å›æ”¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/ch03-fig03.png&#34; alt=&#34;ddia-3-3-compaction-sim.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®©å…¶&lt;strong&gt;å·¥ä¸šå¯ç”¨&lt;/strong&gt;ï¼Œè¿˜æœ‰å¾ˆå¤šé—®é¢˜éœ€è¦è§£å†³ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ–‡ä»¶æ ¼å¼&lt;/strong&gt;ã€‚å¯¹äº&lt;strong&gt;æ—¥å¿—&lt;/strong&gt;æ¥è¯´ï¼ŒCSV ä¸æ˜¯ä¸€ç§ç´§å‡‘çš„æ•°æ®æ ¼å¼ï¼Œæœ‰å¾ˆå¤šç©ºé—´æµªè´¹ã€‚æ¯”å¦‚ï¼Œå¯ä»¥ç”¨ length + record bytes ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®°å½•åˆ é™¤&lt;/strong&gt;ã€‚ä¹‹å‰åªæ”¯æŒ put\getï¼Œä½†å®é™…è¿˜éœ€è¦æ”¯æŒ deleteã€‚ä½†æ—¥å¿—ç»“æ„åˆä¸æ”¯æŒæ›´æ–°ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿä¸€èˆ¬æ˜¯å†™ä¸€ä¸ªç‰¹æ®Šæ ‡è®°ï¼ˆæ¯”å¦‚å¢“ç¢‘è®°å½•ï¼Œtombstoneï¼‰ä»¥è¡¨ç¤ºè¯¥è®°å½•å·²åˆ é™¤ã€‚ä¹‹å compact æ—¶çœŸæ­£åˆ é™¤å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®•æœºæ¢å¤&lt;/strong&gt;ã€‚åœ¨æœºå™¨é‡å¯æ—¶ï¼Œå†…å­˜ä¸­çš„å“ˆå¸Œç´¢å¼•å°†ä¼šä¸¢å¤±ã€‚å½“ç„¶ï¼Œå¯ä»¥å…¨ç›˜æ‰«æä»¥é‡å»ºï¼Œä½†é€šå¸¸ä¸€ä¸ªå°ä¼˜åŒ–æ˜¯ï¼Œå¯¹äºæ¯ä¸ª segment fileï¼Œ å°†å…¶ç´¢å¼•æ¡ç›®å’Œæ•°æ®æ–‡ä»¶ä¸€å—æŒä¹…åŒ–ï¼Œé‡å¯æ—¶åªéœ€åŠ è½½ç´¢å¼•æ¡ç›®å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®°å½•å†™åã€å°‘å†™&lt;/strong&gt;ã€‚ç³»ç»Ÿä»»ä½•æ—¶å€™éƒ½æœ‰å¯èƒ½å®•æœºï¼Œç”±æ­¤ä¼šé€ æˆè®°å½•å†™åã€å°‘å†™ã€‚ä¸ºäº†è¯†åˆ«é”™è¯¯è®°å½•ï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ ä¸€äº›æ ¡éªŒå­—æ®µï¼Œä»¥è¯†åˆ«å¹¶è·³è¿‡è¿™ç§æ•°æ®ã€‚ä¸ºäº†è·³è¿‡å†™äº†éƒ¨åˆ†çš„æ•°æ®ï¼Œè¿˜è¦ç”¨ä¸€äº›ç‰¹æ®Šå­—ç¬¦æ¥æ ‡è¯†è®°å½•é—´çš„è¾¹ç•Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¶å‘æ§åˆ¶&lt;/strong&gt;ã€‚ç”±äºåªæœ‰ä¸€ä¸ªæ´»åŠ¨ï¼ˆè¿½åŠ ï¼‰æ–‡ä»¶ï¼Œå› æ­¤å†™åªæœ‰ä¸€ä¸ªå¤©ç„¶å¹¶å‘åº¦ã€‚ä½†å…¶ä»–çš„æ–‡ä»¶éƒ½æ˜¯ä¸å¯å˜çš„ï¼ˆcompact æ—¶ä¼šè¯»å–ç„¶åç”Ÿæˆæ–°çš„ï¼‰ï¼Œå› æ­¤è¯»å–å’Œç´§ç¼©å¯ä»¥å¹¶å‘æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¹ä¸€çœ‹ï¼ŒåŸºäºæ—¥å¿—çš„å­˜å‚¨ç»“æ„å­˜åœ¨ç€ä¸å°‘æµªè´¹ï¼šéœ€è¦è¿½åŠ è¿›è¡Œæ›´æ–°å’Œåˆ é™¤ã€‚ä½†æ—¥å¿—ç»“æ„æœ‰å‡ ä¸ªåŸåœ°æ›´æ–°ç»“æ„æ— æ³•åšçš„ä¼˜ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä»¥é¡ºåºå†™ä»£æ›¿éšæœºå†™&lt;/strong&gt;ã€‚å¯¹äºç£ç›˜å’Œ SSDï¼Œé¡ºåºå†™éƒ½è¦æ¯”éšæœºå†™å¿«å‡ ä¸ªæ•°é‡çº§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€æ˜“çš„å¹¶å‘æ§åˆ¶&lt;/strong&gt;ã€‚ç”±äºå¤§éƒ¨åˆ†çš„æ–‡ä»¶éƒ½æ˜¯ä¸å¯å˜ï¼ˆimmutableï¼‰çš„ï¼Œå› æ­¤æ›´å®¹æ˜“åšå¹¶å‘è¯»å–å’Œç´§ç¼©ã€‚ä¹Ÿä¸ç”¨æ‹…å¿ƒåŸåœ°æ›´æ–°ä¼šé€ æˆæ–°è€æ•°æ®äº¤æ›¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›´å°‘çš„å†…éƒ¨ç¢ç‰‡&lt;/strong&gt;ã€‚æ¯æ¬¡ç´§ç¼©ä¼šå°†åƒåœ¾å®Œå…¨æŒ¤å‡ºã€‚ä½†æ˜¯åŸåœ°æ›´æ–°å°±ä¼šåœ¨ page ä¸­ç•™ä¸‹ä¸€äº›ä¸å¯ç”¨ç©ºé—´&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;3-sstable&#34;&gt;3. SSTable&lt;/h3&gt;
&lt;p&gt;ä¸Šä¸€èŠ‚è®²çš„åŸºäºå†…å­˜çš„å“ˆå¸Œç´¢å¼•ä¹Ÿæœ‰å…¶å±€é™ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ‰€æœ‰ Key å¿…é¡»æ”¾å†…å­˜&lt;/strong&gt;ï¼šä¸€æ—¦ Key çš„æ•°æ®é‡è¶…è¿‡å†…å­˜å¤§å°ï¼Œè¿™ç§æ–¹æ¡ˆä¾¿ä¸å† workã€‚å½“ç„¶ä½ å¯ä»¥è®¾è®¡åŸºäºç£ç›˜çš„å“ˆå¸Œè¡¨ï¼Œä½†é‚£åˆä¼šå¸¦æ¥å¤§é‡çš„éšæœºå†™&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢&lt;/strong&gt;ï¼šç”±äº key æ˜¯æ— åºçš„ï¼Œä¸èƒ½ç®€å•çš„æ”¯æŒæ‰«ækitty001åˆ°kitty999åŒºé—´å†…çš„æ‰€æœ‰keyï¼Œåªèƒ½é‡‡ç”¨é€ä¸ªæŸ¥æ‰¾çš„æ–¹å¼æŸ¥è¯¢æ¯ä¸ªkey&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;compactæ•ˆç‡ä½&lt;/strong&gt;ï¼šæ—¥å¿—æ–‡ä»¶compactéœ€è¦éå†æ–‡ä»¶å†…å®¹ï¼Œæ•ˆç‡ä½ä¸‹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ‰è¿™äº›å±€é™çš„ä¸»è¦åŸå› æ˜¯åœ¨å¤–å­˜ä¸Šçš„æ•°æ®æ˜¯ç®€å•è¿½åŠ å†™è€Œå½¢æˆçš„ï¼Œå¹¶æ²¡æœ‰æŒ‰ç…§æŸä¸ªå­—æ®µæœ‰åºã€‚å‡è®¾åŠ ä¸€ä¸ªé™åˆ¶ï¼Œè®©è¿™äº›æ–‡ä»¶æŒ‰ key æœ‰åºã€‚æˆ‘ä»¬ç§°è¿™ç§æ ¼å¼ä¸ºï¼šSSTableï¼ˆSorted String Tableï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§æ–‡ä»¶æ ¼å¼æœ‰ä»€ä¹ˆä¼˜ç‚¹å‘¢ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é«˜æ•ˆçš„æ•°æ®æ–‡ä»¶åˆå¹¶&lt;/strong&gt;ã€‚å³æœ‰åºæ–‡ä»¶çš„å½’å¹¶å¤–æ’ï¼Œé¡ºåºè¯»ï¼Œé¡ºåºå†™&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/ch03-fig04.png&#34; alt=&#34;ddia-3-4-merge-sst.png&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸éœ€è¦åœ¨å†…å­˜ä¸­ä¿å­˜æ‰€æœ‰æ•°æ®çš„ç´¢å¼•&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä»…éœ€è¦è®°å½•ä¸‹æ¯ä¸ªæ–‡ä»¶ç•Œé™ï¼ˆä»¥åŒºé—´è¡¨ç¤ºï¼š[startKey, endKey]ï¼Œå½“ç„¶å®é™…ä¼šè®°å½•çš„æ›´ç»†ï¼‰å³å¯ã€‚æŸ¥æ‰¾æŸä¸ª Key æ—¶ï¼Œå»æ‰€æœ‰åŒ…å«è¯¥ Key çš„åŒºé—´å¯¹åº”çš„æ–‡ä»¶äºŒåˆ†æŸ¥æ‰¾å³å¯ï¼ˆä¹Ÿå³æ˜¯&lt;strong&gt;ç¨€ç–ç´¢å¼•&lt;/strong&gt;ï¼‰åœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾ç‰¹å®šçš„keyæ—¶ï¼Œä¸å†éœ€è¦åœ¨å†…å­˜ä¸­ä¿å­˜æ‰€æœ‰é”®çš„ç´¢å¼•ã€‚ å¦‚ä¸‹å›¾å‡è®¾æ­£åœ¨æŸ¥æ‰¾handiwork ï¼Œä¸”ä¸çŸ¥é“è¯¥é”®åœ¨æ®µæ–‡ä»¶ä¸­çš„ç¡®åˆ‡åç§»ã€‚ä½†æ˜¯ï¼Œå¦‚æœçŸ¥é“handbag å’Œhandsome çš„åç§» ï¼Œè€ƒè™‘åˆ°æ ¹æ®é”®æ’åºï¼Œåˆ™é”®handiworkä¸€å®šä½äºå®ƒä»¬ä¸¤è€…ä¹‹é—´ã€‚è¿™æ„å‘³ç€å¯ä»¥è·³åˆ°handbag çš„åç§»ï¼Œä»é‚£é‡Œå¼€å§‹æ‰«æï¼Œç›´åˆ°æ‰¾åˆ°hÎ±ndiwork,å¦‚æœæ‰¾åˆ°handsomeéƒ½è¿˜æ²¡æ‰¾åˆ°åˆ™å¯ä»¥æ–­å®šè¿™ä¸ªæ–‡ä»¶ä¸­æ²¡æœ‰handiworkè¿™ä¸ªkeyçš„è®°å½•&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://s2.loli.net/2022/04/16/j8tM6IUk1QrJXuw.png&#34; alt=&#34;ddia-3-5-sst-index.png&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†å—å‹ç¼©ï¼ŒèŠ‚çœç©ºé—´ï¼Œå‡å°‘ IO&lt;/strong&gt;ã€‚ç›¸é‚» Key å…±äº«å‰ç¼€ï¼Œæ—¢ç„¶æ¯æ¬¡éƒ½è¦æ‰¹é‡å–ï¼Œé‚£æ­£å¥½ä¸€ç»„ key batch åˆ°ä¸€å—ï¼Œç§°ä¸º blockï¼Œä¸”åªè®°å½• block çš„ç´¢å¼•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;æ„å»ºå’Œç»´æŠ¤-sstables&#34;&gt;æ„å»ºå’Œç»´æŠ¤ SSTables&lt;/h4&gt;
&lt;p&gt;SSTables æ ¼å¼å¬èµ·æ¥å¾ˆç¾å¥½ï¼Œä½†é¡»çŸ¥æ•°æ®æ˜¯ä¹±åºçš„æ¥çš„ï¼Œæˆ‘ä»¬å¦‚ä½•å¾—åˆ°æœ‰åºçš„æ•°æ®æ–‡ä»¶å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™å¯ä»¥æ‹†è§£ä¸ºä¸¤ä¸ªå°é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ„å»º SSTable æ–‡ä»¶&lt;/strong&gt;ã€‚å°†ä¹±åºæ•°æ®åœ¨å¤–å­˜ï¼ˆç£ç›˜ or SSDï¼‰ä¸­ä¸Šæ•´ç†ä¸ºæœ‰åºæ–‡ä»¶ï¼Œæ˜¯æ¯”è¾ƒéš¾çš„ã€‚ä½†æ˜¯åœ¨å†…å­˜å°±æ–¹ä¾¿çš„å¤šã€‚äºæ˜¯ä¸€ä¸ªå¤§èƒ†çš„æƒ³æ³•å°±å½¢æˆäº†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ªæœ‰åºç»“æ„ï¼ˆç§°ä¸º &lt;strong&gt;MemTable&lt;/strong&gt;ï¼‰ã€‚å…¸å‹å®ç°å¦‚ï¼šçº¢é»‘æ ‘ã€AVL æ ‘ã€è·³è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;åˆ°è¾¾ä¸€å®šé˜ˆå€¼ä¹‹åå…¨é‡ dump åˆ°å¤–å­˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;ç»´æŠ¤ SSTable æ–‡ä»¶&lt;/strong&gt;ã€‚ä¸ºä»€ä¹ˆéœ€è¦ç»´æŠ¤å‘¢ï¼Ÿé¦–å…ˆè¦é—®ï¼Œå¯¹äºä¸Šè¿°å¤åˆç»“æ„ï¼Œæˆ‘ä»¬æ€ä¹ˆè¿›è¡ŒæŸ¥è¯¢ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆå» MemTable ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœå‘½ä¸­åˆ™è¿”å›ã€‚&lt;/li&gt;
&lt;li&gt;å†å» SSTable æŒ‰æ—¶é—´é¡ºåºç”±æ–°åˆ°æ—§é€ä¸€æŸ¥æ‰¾ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœ SSTable æ–‡ä»¶è¶Šæ¥è¶Šå¤šï¼Œåˆ™æŸ¥æ‰¾ä»£ä»·ä¼šè¶Šæ¥è¶Šå¤§ã€‚å› æ­¤éœ€è¦å°†å¤šä¸ª SSTable æ–‡ä»¶åˆå¹¶ï¼Œä»¥å‡å°‘æ–‡ä»¶æ•°é‡ï¼ŒåŒæ—¶è¿›è¡Œ GCï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º&lt;strong&gt;ç´§ç¼©&lt;/strong&gt;ï¼ˆ Compactionï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¯¥æ–¹æ¡ˆçš„é—®é¢˜&lt;/strong&gt;ï¼šå¦‚æœå‡ºç°å®•æœºï¼Œå†…å­˜ä¸­çš„æ•°æ®ç»“æ„å°†ä¼šæ¶ˆå¤±ã€‚ è§£å†³æ–¹æ³•ä¹Ÿå¾ˆç»å…¸ï¼šWALã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»-sstables-åˆ°-lsm-tree&#34;&gt;ä» SSTables åˆ° LSM-Tree&lt;/h3&gt;
&lt;p&gt;å°†å‰é¢å‡ èŠ‚çš„ä¸€äº›ç¢ç‰‡æœ‰æœºçš„ç»„ç»‡èµ·æ¥ï¼Œä¾¿æ˜¯æ—¶ä¸‹æµè¡Œçš„å­˜å‚¨å¼•æ“ LevelDB å’Œ RocksDB åé¢çš„å­˜å‚¨ç»“æ„ï¼šLSM-Tree&lt;/p&gt;
&lt;p&gt;è¿™ç§æ•°æ®ç»“æ„æ˜¯ Patrick Oâ€™Neil ç­‰äººï¼Œåœ¨ 1996 å¹´æå‡ºçš„ï¼š&lt;a href=&#34;https://www.cs.umb.edu/~poneil/lsmtree.pdf&#34; title=&#34;The Log-Structured Merge-Tree&#34;&gt;The Log-Structured Merge-Tree&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Elasticsearch å’Œ Solr çš„ç´¢å¼•å¼•æ“ Luceneï¼Œä¹Ÿä½¿ç”¨ç±»ä¼¼ LSM-Tree å­˜å‚¨ç»“æ„ã€‚ä½†å…¶æ•°æ®æ¨¡å‹ä¸æ˜¯ KVï¼Œä½†ç±»ä¼¼ï¼šword â†’ document listã€‚&lt;/p&gt;
&lt;h5 id=&#34;lsm-treeçš„æ€§èƒ½ä¼˜åŒ–&#34;&gt;LSM-Treeçš„æ€§èƒ½ä¼˜åŒ–&lt;/h5&gt;
&lt;p&gt;å¦‚æœæƒ³è®©ä¸€ä¸ªå¼•æ“å·¥ç¨‹ä¸Šå¯ç”¨ï¼Œè¿˜ä¼šåšå¤§é‡çš„æ€§èƒ½ä¼˜åŒ–ã€‚å¯¹äº LSM-Tree æ¥è¯´ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¼˜åŒ– SSTable çš„æŸ¥æ‰¾&lt;/strong&gt; ï¼šå¸¸ç”¨ &lt;a href=&#34;https://www.qtmuniao.com/2020/11/18/leveldb-data-structures-bloom-filter/&#34;&gt;&lt;strong&gt;Bloom Filter&lt;/strong&gt;&lt;/a&gt;ã€‚è¯¥æ•°æ®ç»“æ„å¯ä»¥ä½¿ç”¨è¾ƒå°‘çš„å†…å­˜ä¸ºæ¯ä¸ª SSTable åšä¸€äº›æŒ‡çº¹ï¼Œèµ·åˆ°ä¸€äº›åˆç­›çš„ä½œç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å±‚çº§åŒ–ç»„ç»‡ SSTable&lt;/strong&gt;ï¼šä»¥æ§åˆ¶ Compaction çš„é¡ºåºå’Œæ—¶é—´ã€‚å¸¸è§çš„æœ‰ size-tiered å’Œ leveled compactionã€‚LevelDB ä¾¿æ˜¯æ”¯æŒåè€…è€Œå¾—åã€‚å‰è€…æ¯”è¾ƒç®€å•ç²—æš´ï¼Œåè€…æ€§èƒ½æ›´å¥½ï¼Œä¹Ÿå› æ­¤æ›´ä¸ºå¸¸è§ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/ch03-sized-tiered.png&#34; alt=&#34;ddia-sized-tierd-compact.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äº RocksDB æ¥è¯´ï¼Œå·¥ç¨‹ä¸Šçš„ä¼˜åŒ–å’Œä½¿ç”¨ä¸Šçš„ä¼˜åŒ–å°±æ›´å¤šäº†ã€‚åœ¨å…¶ &lt;a href=&#34;https://github.com/facebook/rocksdb/wiki&#34; title=&#34;rocksdb wiki&#34;&gt;Wiki&lt;/a&gt; ä¸Šéšä¾¿æ‘˜å½•å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Column Family&lt;/li&gt;
&lt;li&gt;å‰ç¼€å‹ç¼©å’Œè¿‡æ»¤&lt;/li&gt;
&lt;li&gt;é”®å€¼åˆ†ç¦»ï¼ŒBlobDB&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½†æ— è®ºæœ‰å¤šå°‘å˜ç§å’Œä¼˜åŒ–ï¼ŒLSM-Tree çš„æ ¸å¿ƒæ€æƒ³â€”â€”&lt;strong&gt;ä¿å­˜ä¸€ç»„åˆç†ç»„ç»‡ã€åå°åˆå¹¶çš„ SSTables&lt;/strong&gt; â€”â€”ç®€çº¦è€Œå¼ºå¤§ã€‚å¯ä»¥æ–¹ä¾¿çš„è¿›è¡ŒèŒƒå›´éå†ï¼Œå¯ä»¥å˜å¤§é‡éšæœºä¸ºå°‘é‡é¡ºåºã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¦ä¸€ä¸ªä¸–ç•Œ-b-æ—æ ‘&#34;&gt;å¦ä¸€ä¸ªä¸–ç•Œ-B æ—æ ‘&lt;/h2&gt;
&lt;p&gt;è™½ç„¶å…ˆè®²çš„ LSM-Treeï¼Œä½†æ˜¯å®ƒè¦æ¯” B+ æ ‘æ–°çš„å¤šã€‚B æ ‘äº 1970 å¹´è¢« R. Bayer and E. McCreight &lt;a href=&#34;https://dl.acm.org/doi/10.1145/1734663.1734671&#34; title=&#34;b tree paper&#34;&gt;æå‡º&lt;/a&gt;åï¼Œä¾¿è¿…é€Ÿæµè¡Œäº†èµ·æ¥ã€‚ç°åœ¨å‡ ä¹æ‰€æœ‰çš„å…³ç³»å‹æ•°æ®ä¸­ï¼Œå®ƒéƒ½æ˜¯æ•°æ®ç´¢å¼•æ ‡å‡†ä¸€èˆ¬çš„å®ç°ã€‚ä¸ LSM-Tree ä¸€æ ·ï¼Œå®ƒä¹Ÿæ”¯æŒé«˜æ•ˆçš„&lt;strong&gt;ç‚¹æŸ¥&lt;/strong&gt;å’Œ&lt;strong&gt;èŒƒå›´æŸ¥&lt;/strong&gt;ï¼Œä½†å´ä½¿ç”¨äº†å®Œå…¨ä¸åŒçš„ç»„ç»‡æ–¹å¼&lt;/p&gt;
&lt;h3 id=&#34;èµ·æº-é¡ºåºå­˜å‚¨çš„scheme&#34;&gt;èµ·æº-é¡ºåºå­˜å‚¨çš„Scheme&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/fig98.png&#34; alt=&#34;image-20220817200550307&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚ä¸Šå›¾æ‰€ç¤ºçš„äºŒç»´è¡¨scheme,æˆ‘ä»¬å¯ä»¥æŠŠè¡Œæ•°æ®é¡ºåºçš„è®°å½•åˆ°å¤–å­˜ï¼ˆåºåˆ—åŒ–è¿‡åï¼‰ä¸Šï¼Ÿ è¿™æ ·è®°å½•æ’å…¥é€Ÿåº¦ä¹Ÿæ˜¯å¯ç”¨åšçš„éå¸¸å¿«çš„ï¼Œä½†é¡ºåºå†™å…¥è¿‡åè¦æŸ¥æ‰¾å’Œæ›´æ–°å°±ç›¸å¯¹æ¯”è¾ƒæ…¢äº†ï¼Œåœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œç”¨äºåŠ å¿«æŸ¥æ‰¾çš„æ•°æ®ç»“æ„è‡ªç„¶å°±æ˜¯æ ‘ï¼Œé‚£èƒ½ä¸èƒ½æŠŠäºŒç»´è¡¨æ•°æ®ä»¥æ ‘çš„å½¢å¼åœ¨ç¡¬ç›˜ä¸Šç»„ç»‡å‘¢ï¼ŸB+æ ‘çš„å‘å±•è¿‡ç¨‹å…¶å®æ˜¯é¢å‘ç¡¬ç›˜ç‰¹æ€§ç¼–ç¨‹çš„æ€è€ƒè¿‡ç¨‹ï¼Œä¸‹é¢ä¸€ä¸€é“æ¥ï¼&lt;/p&gt;
&lt;h3 id=&#34;äºŒå‰æŸ¥æ‰¾æ ‘&#34;&gt;äºŒå‰æŸ¥æ‰¾æ ‘&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/fig99.png&#34; alt=&#34;5fLd8bp0nu&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¸º product è¡¨(äº§å“åº“å­˜è¡¨)å»ºç«‹äº†ä¸€ä¸ªäºŒå‰æŸ¥æ‰¾æ ‘çš„ç´¢å¼•ã€‚&lt;/p&gt;
&lt;p&gt;äºŒå‰æŸ¥æ‰¾æ ‘çš„ç‰¹ç‚¹å°±æ˜¯ä»»ä½•èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹çš„é”®å€¼éƒ½å°äºå½“å‰èŠ‚ç‚¹çš„é”®å€¼ï¼Œå³å­èŠ‚ç‚¹çš„é”®å€¼éƒ½å¤§äºå½“å‰èŠ‚ç‚¹çš„é”®å€¼ã€‚é¡¶ç«¯çš„èŠ‚ç‚¹æˆ‘ä»¬ç§°ä¸ºæ ¹èŠ‚ç‚¹ï¼Œæ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹æˆ‘ä»¬ç§°ä¹‹ä¸ºå¶èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬éœ€è¦æŸ¥æ‰¾ id=5 çš„äº§å“ä¿¡æ¯ï¼Œåˆ©ç”¨æˆ‘ä»¬åˆ›å»ºçš„äºŒå‰æŸ¥æ‰¾æ ‘ç´¢å¼•ï¼ŒæŸ¥æ‰¾æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°†æ ¹èŠ‚ç‚¹ä½œä¸ºå½“å‰èŠ‚ç‚¹ï¼ŒæŠŠ 5ä¸å½“å‰èŠ‚ç‚¹çš„é”®å€¼ 4æ¯”è¾ƒï¼Œ5å¤§äº 4ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æŠŠå½“å‰èŠ‚ç‚¹&amp;gt;çš„å³å­èŠ‚ç‚¹ä½œä¸ºå½“å‰èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;ç»§ç»­æŠŠ 5å’Œå½“å‰èŠ‚ç‚¹çš„é”®å€¼ 6 æ¯”è¾ƒï¼Œå‘ç° 5å°äº 6ï¼ŒæŠŠå½“å‰èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä½œä¸ºå½“å‰èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;æŠŠ 5 å’Œå½“å‰èŠ‚ç‚¹çš„é”®å€¼ 5å¯¹æ¯”ï¼Œ5ç­‰äº 5ï¼Œæ»¡è¶³æ¡ä»¶ï¼Œæˆ‘ä»¬ä»å½“å‰èŠ‚ç‚¹ä¸­å–å‡º dataï¼Œå³ id=5ï¼Œname=book, num=899ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åˆ©ç”¨äºŒå‰æŸ¥æ‰¾æ ‘æˆ‘ä»¬åªéœ€è¦ 3 æ¬¡å³å¯æ‰¾åˆ°åŒ¹é…çš„æ•°æ®ã€‚å¦‚æœåœ¨è¡¨ä¸­ä¸€æ¡æ¡çš„æŸ¥æ‰¾çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦ 5æ¬¡æ‰èƒ½æ‰¾åˆ°&lt;/p&gt;
&lt;h3 id=&#34;å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘&#34;&gt;å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘&lt;/h3&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬è®²è§£äº†åˆ©ç”¨äºŒå‰æŸ¥æ‰¾æ ‘å¯ä»¥å¿«é€Ÿçš„æ‰¾åˆ°æ•°æ®ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸Šé¢çš„äºŒå‰æŸ¥æ‰¾æ ‘æ˜¯è¿™æ ·çš„æ„é€ ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/fig100.png&#34; alt=&#34;image-20220817202250598&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„äºŒå‰æŸ¥æ‰¾æ ‘å˜æˆäº†ä¸€ä¸ªé“¾è¡¨ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦æŸ¥æ‰¾ id=7 çš„äº§å“ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥æ‰¾ 7 æ¬¡ï¼Œä¹Ÿå°±ç›¸å½“äºå…¨è¡¨æ‰«æäº†ã€‚å¯¼è‡´è¿™ä¸ªç°è±¡çš„åŸå› å…¶å®æ˜¯äºŒå‰æŸ¥æ‰¾æ ‘å˜å¾—ä¸å¹³è¡¡äº†ï¼Œä¹Ÿå°±æ˜¯é«˜åº¦å¤ªé«˜äº†ï¼Œä»è€Œå¯¼è‡´æŸ¥æ‰¾æ•ˆç‡çš„ä¸ç¨³å®šï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯äºŒå‰æŸ¥æ‰¾æ ‘ä¸€ç›´ä¿æŒå¹³è¡¡ï¼Œå°±éœ€è¦ç”¨åˆ°å¹³è¡¡äºŒå‰æ ‘äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¹³è¡¡äºŒå‰æ ‘åˆç§° AVL æ ‘ï¼Œåœ¨æ»¡è¶³äºŒå‰æŸ¥æ‰¾æ ‘ç‰¹æ€§çš„åŸºç¡€ä¸Šï¼Œè¦æ±‚æ¯ä¸ªèŠ‚ç‚¹çš„å·¦å³å­æ ‘çš„é«˜åº¦å·®ä¸èƒ½è¶…è¿‡ 1ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯å¹³è¡¡äºŒå‰æ ‘å’Œéå¹³è¡¡äºŒå‰æ ‘çš„å¯¹æ¯”ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/fig101.png&#34; alt=&#34;image-20220817203243292&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç”±å¹³è¡¡äºŒå‰æ ‘çš„æ„é€ æˆ‘ä»¬å¯ä»¥å‘ç°ç¬¬ä¸€å¼ å›¾ä¸­çš„äºŒå‰æ ‘å…¶å®å°±æ˜¯ä¸€æ£µå¹³è¡¡äºŒå‰æ ‘ã€‚&lt;/p&gt;
&lt;p&gt;å¹³è¡¡äºŒå‰æ ‘ä¿è¯äº†æ ‘çš„æ„é€ æ˜¯å¹³è¡¡çš„ï¼Œå½“æˆ‘ä»¬æ’å…¥æˆ–åˆ é™¤æ•°æ®å¯¼è‡´ä¸æ»¡è¶³å¹³è¡¡äºŒå‰æ ‘ä¸å¹³è¡¡æ—¶ï¼Œå¹³è¡¡äºŒå‰æ ‘ä¼šè¿›è¡Œè°ƒæ•´æ ‘ä¸Šçš„èŠ‚ç‚¹æ¥ä¿æŒå¹³è¡¡ã€‚å…·ä½“çš„è°ƒæ•´æ–¹å¼è¿™é‡Œå°±ä¸ä»‹ç»äº†ã€‚å¹³è¡¡äºŒå‰æ ‘ç›¸æ¯”äºäºŒå‰æŸ¥æ‰¾æ ‘æ¥è¯´ï¼ŒæŸ¥æ‰¾æ•ˆç‡æ›´ç¨³å®šï¼Œæ€»ä½“çš„æŸ¥æ‰¾é€Ÿåº¦ä¹Ÿæ›´å¿«ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œè¿˜æœ‰å¾ˆå¤šè‡ªå¹³è¡¡çš„äºŒå‰æ ‘ï¼Œæ¯”å¦‚çº¢é»‘æ ‘ï¼Œå®ƒä¹Ÿæ˜¯é€šè¿‡ä¸€äº›çº¦æŸæ¡ä»¶æ¥è¾¾åˆ°è‡ªå¹³è¡¡ï¼Œä¸è¿‡çº¢é»‘æ ‘çš„çº¦æŸæ¡ä»¶æ¯”è¾ƒå¤æ‚ï¼Œä¸æ˜¯æœ¬ç¯‡çš„é‡ç‚¹ï¼Œå¤§å®¶å¯ä»¥çœ‹ã€Šæ•°æ®ç»“æ„ã€‹ç›¸å…³çš„ä¹¦ç±æ¥äº†è§£çº¢é»‘æ ‘çš„çº¦æŸæ¡ä»¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;b-æ ‘&#34;&gt;B æ ‘&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ä¸ç®¡å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘è¿˜æ˜¯çº¢é»‘æ ‘ï¼Œéƒ½ä¼šéšç€æ’å…¥çš„å…ƒç´ å¢å¤šï¼Œè€Œå¯¼è‡´æ ‘çš„é«˜åº¦å˜é«˜ï¼Œè¿™å°±æ„å‘³ç€ç£ç›˜ I/O æ“ä½œæ¬¡æ•°å¤šï¼Œä¼šå½±å“æ•´ä½“æ•°æ®æŸ¥è¯¢çš„æ•ˆç‡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œä¸‹é¢è¿™ä¸ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘çš„é«˜åº¦ä¸º 5ï¼Œé‚£ä¹ˆåœ¨è®¿é—®æœ€åº•éƒ¨çš„èŠ‚ç‚¹æ—¶ï¼Œå°±éœ€è¦ç£ç›˜ 5 æ¬¡ I/O æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img-blog.csdnimg.cn/img_convert/2d26d30c953cd47c6ab637ad0eba2f99.png&#34; alt=&#34;å›¾ç‰‡&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æœ¬åŸå› æ˜¯å› ä¸ºå®ƒä»¬éƒ½æ˜¯äºŒå‰æ ‘ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªèŠ‚ç‚¹åªèƒ½ä¿å­˜ 2 ä¸ªå­èŠ‚ç‚¹ ï¼Œå¦‚æœæˆ‘ä»¬æŠŠäºŒå‰æ ‘æ”¹æˆ M å‰æ ‘ï¼ˆM&amp;gt;2ï¼‰å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œå½“ M=3 æ—¶ï¼Œåœ¨åŒæ ·çš„èŠ‚ç‚¹ä¸ªæ•°æƒ…å†µä¸‹ï¼Œä¸‰å‰æ ‘æ¯”äºŒå‰æ ‘çš„æ ‘è¦çŸ®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img-blog.csdnimg.cn/img_convert/00fb73de7014a87958f1597345e9ef2f.png&#34; alt=&#34;å›¾ç‰‡&#34;&gt;&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œ&lt;strong&gt;å½“æ ‘çš„èŠ‚ç‚¹è¶Šå¤šçš„æ—¶å€™ï¼Œå¹¶ä¸”æ ‘çš„åˆ†å‰æ•° M è¶Šå¤§çš„æ—¶å€™ï¼ŒM å‰æ ‘çš„é«˜åº¦ä¼šè¿œå°äºäºŒå‰æ ‘çš„é«˜åº¦&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªå¹³è¡¡äºŒå‰æ ‘è™½ç„¶èƒ½ä¿æŒæŸ¥è¯¢æ“ä½œçš„æ—¶é—´å¤æ‚åº¦åœ¨O(logn)ï¼Œä½†æ˜¯å› ä¸ºå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹åªèƒ½æœ‰ 2 ä¸ªå­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå½“èŠ‚ç‚¹ä¸ªæ•°è¶Šå¤šçš„æ—¶å€™ï¼Œæ ‘çš„é«˜åº¦ä¹Ÿä¼šç›¸åº”å˜é«˜ï¼Œè¿™æ ·å°±ä¼šå¢åŠ ç£ç›˜çš„ I/O æ¬¡æ•°ï¼Œä»è€Œå½±å“æ•°æ®æŸ¥è¯¢çš„æ•ˆç‡ã€‚ä¸ºäº†è§£å†³æ ‘çš„é«˜åº¦çš„é—®é¢˜ï¼Œåé¢å°±å‡ºæ¥äº† B æ ‘ï¼Œå®ƒä¸å†é™åˆ¶ä¸€ä¸ªèŠ‚ç‚¹å°±åªèƒ½æœ‰ 2 ä¸ªå­èŠ‚ç‚¹ï¼Œè€Œæ˜¯å…è®¸ M ä¸ªå­èŠ‚ç‚¹ (M&amp;gt;2)ï¼Œä»è€Œé™ä½æ ‘çš„é«˜åº¦ã€‚B æ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹æœ€å¤šå¯ä»¥åŒ…æ‹¬ M ä¸ªå­èŠ‚ç‚¹ï¼ŒM ç§°ä¸º B æ ‘çš„é˜¶ï¼Œæ‰€ä»¥ B æ ‘å°±æ˜¯ä¸€ä¸ªå¤šå‰æ ‘ã€‚
Bæ ‘ç›¸å¯¹å¹³è¡¡äºŒå‰æ ‘åœ¨èŠ‚ç‚¹ç©ºé—´çš„åˆ©ç”¨ç‡ä¸Šè¿›è¡Œæ”¹è¿›ï¼ŒBæ ‘åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¿å­˜æ›´å¤šçš„æ•°æ®ï¼Œå‡å°‘äº†æ ‘çš„é«˜åº¦ï¼Œä»è€Œæå‡äº†æŸ¥æ‰¾çš„æ€§èƒ½ï¼Œåœ¨æ•°æ®åº“åº”ç”¨ä¸­ï¼ŒBæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨çš„æ•°æ®é‡å¤§çº¦ä¸º4K, è¿™æ˜¯å› ä¸ºè€ƒè™‘åˆ°ç£ç›˜æ•°æ®å­˜å‚¨æ˜¯é‡‡ç”¨å—çš„å½¢å¼å­˜å‚¨çš„ï¼Œæ¯ä¸ªå—çš„å¤§å°ä¸º4Kï¼Œæ¯æ¬¡å¯¹ç£ç›˜è¿›è¡ŒIOæ•°æ®è¯»å–æ—¶ï¼ŒåŒä¸€ä¸ªç£ç›˜å—çš„æ•°æ®ä¼šè¢«ä¸€æ¬¡æ€§è¯»å–å‡ºæ¥ï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡ç£ç›˜IOéƒ½å¯ä»¥è¯»å–åˆ°Bæ ‘ä¸­ä¸€ä¸ªèŠ‚ç‚¹çš„å…¨éƒ¨æ•°æ®ã€‚ã€&lt;/p&gt;
&lt;h3 id=&#34;b-æ ‘-1&#34;&gt;B+ æ ‘&lt;/h3&gt;
&lt;p&gt;B+ æ ‘å°±æ˜¯å¯¹ B æ ‘åšäº†ä¸€ä¸ªå‡çº§ï¼ŒMySQL ä¸­ç´¢å¼•çš„æ•°æ®ç»“æ„å°±æ˜¯é‡‡ç”¨äº† B+ æ ‘ï¼ŒB+ æ ‘ç»“æ„å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://img-blog.csdnimg.cn/img_convert/b6678c667053a356f46fc5691d2f5878.png&#34; alt=&#34;å›¾ç‰‡&#34;&gt;&lt;/p&gt;
&lt;p&gt;B+ æ ‘ä¸ B æ ‘å·®å¼‚çš„ç‚¹ï¼Œä¸»è¦æ˜¯ä»¥ä¸‹è¿™å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¶å­èŠ‚ç‚¹ï¼ˆæœ€åº•éƒ¨çš„èŠ‚ç‚¹ï¼‰æ‰ä¼šå­˜æ”¾å®é™…æ•°æ®ï¼ˆç´¢å¼•+è®°å½•ï¼‰ï¼Œéå¶å­èŠ‚ç‚¹åªä¼šå­˜æ”¾ç´¢å¼•ï¼›&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰ç´¢å¼•éƒ½ä¼šåœ¨å¶å­èŠ‚ç‚¹å‡ºç°ï¼Œå¶å­èŠ‚ç‚¹ä¹‹é—´æ„æˆä¸€ä¸ªæœ‰åºé“¾è¡¨ï¼›&lt;/li&gt;
&lt;li&gt;éå¶å­èŠ‚ç‚¹çš„ç´¢å¼•ä¹Ÿä¼šåŒæ—¶å­˜åœ¨åœ¨å­èŠ‚ç‚¹ä¸­ï¼Œå¹¶ä¸”æ˜¯åœ¨å­èŠ‚ç‚¹ä¸­æ‰€æœ‰ç´¢å¼•çš„æœ€å¤§ï¼ˆæˆ–æœ€å°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;éå¶å­èŠ‚ç‚¹ä¸­æœ‰å¤šå°‘ä¸ªå­èŠ‚ç‚¹ï¼Œå°±æœ‰å¤šå°‘ä¸ªç´¢å¼•ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;æŸ¥æ‰¾&lt;/strong&gt;ã€‚ä»æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œè¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œç„¶ååŠ è½½æ–°çš„é¡µåˆ°å†…å­˜ä¸­ï¼Œç»§ç»­äºŒåˆ†ï¼Œç›´åˆ°å‘½ä¸­æˆ–è€…åˆ°å¶å­èŠ‚ç‚¹ã€‚ æŸ¥æ‰¾å¤æ‚åº¦ï¼Œæ ‘çš„é«˜åº¦â€”â€” O(lgn)ï¼Œå½±å“æ ‘é«˜åº¦çš„å› ç´ ï¼šåˆ†æ”¯å› å­ï¼ˆåˆ†å‰æ•°ï¼Œé€šå¸¸æ˜¯å‡ ç™¾ä¸ªï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ’å…¥ or æ›´æ–°&lt;/strong&gt;ã€‚å’ŒæŸ¥æ‰¾è¿‡ç¨‹ä¸€æ ·ï¼Œå®šä½åˆ°åŸ Key æ‰€åœ¨é¡µï¼Œæ’å…¥æˆ–è€…æ›´æ–°åï¼Œå°†é¡µå®Œæ•´å†™å›ã€‚å¦‚æœé¡µå‰©ä½™ç©ºé—´ä¸å¤Ÿï¼Œåˆ™åˆ†è£‚åå†™å…¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆ†è£‚ or åˆå¹¶&lt;/strong&gt;ã€‚çº§è”åˆ†è£‚å’Œåˆå¹¶ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ä¸€ä¸ªè®°å½•å¤§äºä¸€ä¸ª page æ€ä¹ˆåŠï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ ‘çš„èŠ‚ç‚¹æ˜¯é€»è¾‘æ¦‚å¿µï¼Œpage or block æ˜¯ç‰©ç†æ¦‚å¿µã€‚ä¸€ä¸ªé€»è¾‘èŠ‚ç‚¹å¯ä»¥å¯¹åº”å¤šä¸ªç‰©ç† pageã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;bæ ‘ä¼˜åŒ–&#34;&gt;B+æ ‘ä¼˜åŒ–&lt;/h3&gt;
&lt;p&gt;B+æ ‘ä¸åƒ LSM-Tree ï¼Œä¼šåœ¨åŸåœ°ä¿®æ”¹æ•°æ®æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ ‘ç»“æ„è°ƒæ•´æ—¶ï¼Œå¯èƒ½ä¼šçº§è”ä¿®æ”¹å¾ˆå¤š Pageã€‚æ¯”å¦‚å¶å­èŠ‚ç‚¹åˆ†è£‚åï¼Œå°±éœ€è¦å†™å…¥ä¸¤ä¸ªæ–°çš„å¶å­èŠ‚ç‚¹ï¼Œå’Œä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼ˆæ›´æ–°å¶å­æŒ‡é’ˆï¼‰ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¢åŠ é¢„å†™æ—¥å¿—ï¼ˆWALï¼‰ï¼Œå°†æ‰€æœ‰ä¿®æ”¹æ“ä½œè®°å½•ä¸‹æ¥ï¼Œé¢„é˜²å®•æœºæ—¶ä¸­æ–­æ ‘ç»“æ„è°ƒæ•´è€Œäº§ç”Ÿçš„æ··ä¹±ç°åœºã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ latch å¯¹æ ‘ç»“æ„è¿›è¡Œå¹¶å‘æ§åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ä½¿ç”¨ WALï¼Œè€Œåœ¨å†™å…¥æ—¶åˆ©ç”¨ Copy On Write æŠ€æœ¯ã€‚åŒæ—¶ï¼Œä¹Ÿæ–¹ä¾¿äº†å¹¶å‘æ§åˆ¶ã€‚å¦‚ LMDBã€BoltDBã€‚&lt;/li&gt;
&lt;li&gt;å¯¹ä¸­é—´èŠ‚ç‚¹çš„ Key åšå‹ç¼©ï¼Œä¿ç•™è¶³å¤Ÿçš„è·¯ç”±ä¿¡æ¯å³å¯ã€‚ä»¥æ­¤ï¼Œå¯ä»¥èŠ‚çœç©ºé—´ï¼Œå¢å¤§åˆ†æ”¯å› å­ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºäº†ä¼˜åŒ–èŒƒå›´æŸ¥è¯¢ï¼Œæœ‰çš„ B æ—æ ‘å°†å¶å­èŠ‚ç‚¹å­˜å‚¨æ—¶ç‰©ç†è¿ç»­ã€‚ä½†å½“æ•°æ®ä¸æ–­æ’å…¥æ—¶ï¼Œç»´æŠ¤æ­¤æœ‰åºæ€§çš„ä»£ä»·éå¸¸å¤§ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºå¶å­èŠ‚ç‚¹å¢åŠ å…„å¼ŸæŒ‡é’ˆï¼Œä»¥é¿å…é¡ºåºéå†æ—¶çš„å›æº¯ã€‚å³ B+ æ ‘çš„åšæ³•ï¼Œä½†è¿œä¸å±€é™äº B+ æ ‘ã€‚&lt;/li&gt;
&lt;li&gt;B æ ‘çš„å˜ç§ï¼Œåˆ†å½¢æ ‘ï¼Œä» LSM-tree å€Ÿé‰´äº†ä¸€äº›æ€æƒ³ä»¥ä¼˜åŒ– seekã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;b-trees-å’Œ-lsm-trees-å¯¹æ¯”&#34;&gt;B-Trees å’Œ LSM-Trees å¯¹æ¯”&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å­˜å‚¨å¼•æ“&lt;/th&gt;
&lt;th&gt;B-Tree&lt;/th&gt;
&lt;th&gt;LSM-Tree&lt;/th&gt;
&lt;th&gt;å¤‡æ³¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ä¼˜åŠ¿&lt;/td&gt;
&lt;td&gt;è¯»å–æ›´å¿«&lt;/td&gt;
&lt;td&gt;å†™å…¥æ›´å¿«&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å†™æ”¾å¤§&lt;/td&gt;
&lt;td&gt;1. æ•°æ®å’Œ WAL&lt;br/&gt;2. æ›´æ”¹æ•°æ®æ—¶å¤šæ¬¡è¦†ç›–æ•´ä¸ª Page&lt;/td&gt;
&lt;td&gt;1. æ•°æ®å’Œ WAL&lt;br/&gt;2. Compaction&lt;/td&gt;
&lt;td&gt;SSD ä¸èƒ½è¿‡å¤šæ“¦é™¤ã€‚å› æ­¤ SSD å†…éƒ¨çš„å›ºä»¶ä¸­ä¹Ÿå¤šç”¨æ—¥å¿—ç»“æ„æ¥å‡å°‘éšæœºå°å†™ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å†™åå&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹è¾ƒä½ï¼š&lt;br/&gt;1. å¤§é‡éšæœºå†™ã€‚&lt;/td&gt;
&lt;td&gt;ç›¸å¯¹è¾ƒé«˜ï¼š&lt;br/&gt;1. è¾ƒä½çš„å†™æ”¾å¤§ï¼ˆå–å†³äºæ•°æ®å’Œé…ç½®ï¼‰&lt;br/&gt;2. é¡ºåºå†™å…¥ã€‚&lt;br/&gt;3. æ›´ä¸ºç´§å‡‘ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å‹ç¼©ç‡&lt;/td&gt;
&lt;td&gt;1. å­˜åœ¨è¾ƒå¤šå†…éƒ¨ç¢ç‰‡ã€‚&lt;/td&gt;
&lt;td&gt;1. æ›´åŠ ç´§å‡‘ï¼Œæ²¡æœ‰å†…éƒ¨ç¢ç‰‡ã€‚&lt;br/&gt;2. å‹ç¼©æ½œåŠ›æ›´å¤§ï¼ˆå…±äº«å‰ç¼€ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;ä½†ç´§ç¼©ä¸åŠæ—¶ä¼šé€ æˆ LSM-Tree å­˜åœ¨å¾ˆå¤šåƒåœ¾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;åå°æµé‡&lt;/td&gt;
&lt;td&gt;1. æ›´ç¨³å®šå¯é¢„æµ‹ï¼Œä¸ä¼šå—åå° compaction çªå‘æµé‡å½±å“ã€‚&lt;/td&gt;
&lt;td&gt;1. å†™ååè¿‡é«˜ï¼Œcompaction è·Ÿä¸ä¸Šï¼Œä¼šè¿›ä¸€æ­¥åŠ é‡è¯»æ”¾å¤§ã€‚&lt;br/&gt;2. ç”±äºå¤–å­˜æ€»å¸¦å®½æœ‰é™ï¼Œcompaction ä¼šå½±å“è¯»å†™ååã€‚&lt;br/&gt;3. éšç€æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œcompaction å¯¹æ­£å¸¸å†™å½±å“è¶Šæ¥è¶Šå¤§ã€‚&lt;/td&gt;
&lt;td&gt;RocksDB å†™å…¥å¤ªè¿‡å¿«ä¼šå¼•èµ· write stallï¼Œå³é™åˆ¶å†™å…¥ï¼Œä»¥æœŸå°½å¿« compaction å°†æ•°æ®ä¸‹æ²‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å­˜å‚¨æ”¾å¤§&lt;/td&gt;
&lt;td&gt;1. æœ‰äº› Page æ²¡æœ‰ç”¨æ»¡&lt;/td&gt;
&lt;td&gt;1. åŒä¸€ä¸ª Key å­˜å¤šé&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¹¶å‘æ§åˆ¶&lt;/td&gt;
&lt;td&gt;1. åŒä¸€ä¸ª Key åªå­˜åœ¨ä¸€ä¸ªåœ°æ–¹&lt;br/&gt;2. æ ‘ç»“æ„å®¹æ˜“åŠ èŒƒå›´é”ã€‚&lt;/td&gt;
&lt;td&gt;åŒä¸€ä¸ª Key ä¼šå­˜å¤šéï¼Œä¸€èˆ¬ä½¿ç”¨ MVCC è¿›è¡Œæ§åˆ¶ã€‚&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;å­˜å‚¨å¼•æ“çš„å…¶ä»–åº”ç”¨&#34;&gt;å­˜å‚¨å¼•æ“çš„å…¶ä»–åº”ç”¨&lt;/h2&gt;
&lt;h3 id=&#34;å…¨æ–‡ç´¢å¼•å’Œæ¨¡ç³Šç´¢å¼•&#34;&gt;&lt;strong&gt;å…¨æ–‡ç´¢å¼•å’Œæ¨¡ç³Šç´¢å¼•&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;å‰è¿°ç´¢å¼•åªæä¾›å…¨å­—æ®µçš„ç²¾ç¡®åŒ¹é…ï¼Œè€Œä¸æä¾›ç±»ä¼¼æœç´¢å¼•æ“çš„åŠŸèƒ½ã€‚æ¯”å¦‚ï¼ŒæŒ‰å­—ç¬¦ä¸²ä¸­åŒ…å«çš„å•è¯æŸ¥è¯¢ï¼Œé’ˆå¯¹ç¬”è¯¯çš„å•è¯æŸ¥è¯¢ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å·¥ç¨‹ä¸­å¸¸ç”¨ &lt;a href=&#34;https://lucene.apache.org/&#34; title=&#34;Apace Lucene&#34;&gt;Apace Lucene&lt;/a&gt; åº“ï¼Œå’Œå…¶åŒ…è£…å‡ºæ¥çš„æœåŠ¡ï¼š&lt;a href=&#34;https://www.elastic.co/cn/&#34; title=&#34;Elasticsearch&#34;&gt;Elasticsearch&lt;/a&gt;ã€‚ä»–ä¹Ÿä½¿ç”¨ç±»ä¼¼ LSM-tree çš„æ—¥å¿—å­˜å‚¨ç»“æ„ï¼Œä½†å…¶ç´¢å¼•æ˜¯ä¸€ä¸ªæœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼Œåœ¨è¡Œä¸ºä¸Šç±»ä¼¼ Trie æ ‘ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…¨å†…å­˜æ•°æ®ç»“æ„&#34;&gt;å…¨å†…å­˜æ•°æ®ç»“æ„&lt;/h3&gt;
&lt;p&gt;éšç€å•ä½å†…å­˜æˆæœ¬ä¸‹é™ï¼Œç”šè‡³æ”¯æŒæŒä¹…åŒ–ï¼ˆnon-volatile memoryï¼ŒNVMï¼Œå¦‚ Intel çš„ &lt;a href=&#34;https://www.intel.cn/content/www/cn/zh/products/details/memory-storage/optane-dc-persistent-memory.html&#34; title=&#34;å‚²è…¾&#34;&gt;å‚²è…¾&lt;/a&gt;ï¼‰ï¼Œå…¨å†…å­˜æ•°æ®åº“ä¹Ÿé€æ¸å¼€å§‹æµè¡Œã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ®æ˜¯å¦éœ€è¦æŒä¹…åŒ–ï¼Œå†…å­˜æ•°æ®å¤§æ¦‚å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¸éœ€è¦æŒä¹…åŒ–&lt;/strong&gt;ã€‚å¦‚åªç”¨äºç¼“å­˜çš„ Memcachedã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦æŒä¹…åŒ–&lt;/strong&gt;ã€‚é€šè¿‡ WALã€å®šæœŸ snapshotã€è¿œç¨‹å¤‡ä»½ç­‰ç­‰æ¥å¯¹æ•°æ®è¿›è¡ŒæŒä¹…åŒ–ã€‚ä½†ä½¿ç”¨å†…å­˜å¤„ç†å…¨éƒ¨è¯»å†™ï¼Œå› æ­¤ä»æ˜¯å†…å­˜æ•°æ®åº“ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;VoltDB, MemSQL, and Oracle TimesTen æ˜¯æä¾›å…³ç³»æ¨¡å‹çš„å†…å­˜æ•°æ®åº“ã€‚RAMCloud æ˜¯æä¾›æŒä¹…åŒ–ä¿è¯çš„ KV æ•°æ®åº“ã€‚Redis and Couchbase ä»…æä¾›å¼±æŒä¹…åŒ–ä¿è¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å†…å­˜æ•°æ®åº“å­˜åœ¨ä¼˜åŠ¿çš„åŸå› ä¸ä»…åœ¨äºä¸éœ€è¦è¯»å–ç£ç›˜ï¼Œè€Œåœ¨æ›´äºä¸éœ€è¦å¯¹æ•°æ®ç»“æ„è¿›è¡Œ&lt;strong&gt;åºåˆ—åŒ–ã€ç¼–ç &lt;/strong&gt;åä»¥é€‚åº”ç£ç›˜æ‰€å¸¦æ¥çš„&lt;strong&gt;é¢å¤–å¼€é”€&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œå†…å­˜æ•°æ®åº“è¿˜æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æä¾›æ›´ä¸°å¯Œçš„æ•°æ®æŠ½è±¡&lt;/strong&gt;ã€‚å¦‚ set å’Œ queue è¿™ç§åªå­˜åœ¨äºå†…å­˜ä¸­çš„æ•°æ®æŠ½è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®ç°ç›¸å¯¹ç®€å•&lt;/strong&gt;ã€‚å› ä¸ºæ‰€æœ‰æ•°æ®éƒ½åœ¨å†…å­˜ä¸­ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ­¤å¤–ï¼Œå†…å­˜æ•°æ®åº“è¿˜å¯ä»¥é€šè¿‡ç±»ä¼¼æ“ä½œç³»ç»Ÿ swap çš„æ–¹å¼ï¼Œæä¾›æ¯”ç‰©ç†æœºå†…å­˜æ›´å¤§çš„å­˜å‚¨ç©ºé—´ï¼Œä½†ç”±äºå…¶æœ‰æ›´å¤šæ•°æ®åº“ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥å°†æ¢å…¥æ¢å‡ºçš„ç²’åº¦åšçš„æ›´ç»†ã€æ€§èƒ½åšçš„æ›´å¥½ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäº&lt;strong&gt;éæ˜“å¤±æ€§å­˜å‚¨å™¨&lt;/strong&gt;ï¼ˆnon-volatile memoryï¼ŒNVMï¼‰ çš„å­˜å‚¨å¼•æ“ä¹Ÿæ˜¯è¿™äº›å¹´ç ”ç©¶çš„ä¸€ä¸ªçƒ­ç‚¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åˆ—å­˜&#34;&gt;åˆ—å­˜&lt;/h3&gt;
&lt;p&gt;åœ¨OLAPçš„åœºæ™¯ä¸‹ï¼Œæ•°æ®æœ‰å¯èƒ½è¾¾åˆ°æ•°åäº¿è¡Œå’Œæ•° PB å¤§ã€‚è™½ç„¶äº‹å®è¡¨å¯èƒ½é€šå¸¸æœ‰å‡ åä¸Šç™¾åˆ—ï¼Œä½†æ˜¯å•æ¬¡æŸ¥è¯¢é€šå¸¸åªå…³æ³¨å…¶ä¸­å‡ ä¸ªç»´åº¦ï¼ˆåˆ—ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æŸ¥è¯¢&lt;strong&gt;äººä»¬æ˜¯å¦æ›´å€¾å‘äºåœ¨ä¸€å‘¨çš„æŸä¸€å¤©è´­ä¹°æ–°é²œæ°´æœæˆ–ç³–æœ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;SELECT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim_date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;weekday&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim_product&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;category&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;SUM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fact_sales&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quantity&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;AS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quantity_sold&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fact_sales&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;JOIN&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim_date&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ON&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fact_sales&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;date_key&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim_date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;date_key&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;JOIN&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim_product&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ON&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fact_sales&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;product_sk&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim_product&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;product_sk&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;WHERE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim_date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;year&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2013&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;AND&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim_product&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;category&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;IN&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Fresh fruit&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Candy&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;GROUP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;BY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim_date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;weekday&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim_product&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;category&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç”±äºä¼ ç»Ÿæ•°æ®åº“é€šå¸¸æ˜¯æŒ‰è¡Œå­˜å‚¨çš„ï¼Œè¿™æ„å‘³ç€å¯¹äºå±æ€§ï¼ˆåˆ—ï¼‰å¾ˆå¤šçš„è¡¨ï¼Œå“ªæ€•åªæŸ¥è¯¢ä¸€ä¸ªå±æ€§ï¼Œä¹Ÿå¿…é¡»ä»ç£ç›˜ä¸Šå–å‡ºå¾ˆå¤šå±æ€§ï¼Œæ— ç–‘æµªè´¹äº† IO å¸¦å®½ã€å¢å¤§äº†è¯»æ”¾å¤§ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æƒ³æ³•å‘¼ä¹‹æ¬²å‡ºï¼šæ¯ä¸€ä¸ªåˆ—åˆ†å¼€å­˜å‚¨å¥½ä¸å¥½ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/ch03-fig10.png&#34; alt=&#34;ddia-3-10-store-by-column.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸åŒåˆ—ä¹‹é—´åŒä¸€ä¸ªè¡Œçš„å­—æ®µå¯ä»¥é€šè¿‡ä¸‹æ ‡æ¥å¯¹åº”ã€‚å½“ç„¶ä¹Ÿå¯ä»¥å†…åµŒä¸»é”®æ¥å¯¹åº”ï¼Œä½†é‚£æ ·å­˜å‚¨æˆæœ¬å°±å¤ªé«˜äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;åˆ—å‹ç¼©&#34;&gt;åˆ—å‹ç¼©&lt;/h4&gt;
&lt;p&gt;å°†æ‰€æœ‰æ•°æ®åˆ†åˆ—å­˜å‚¨åœ¨ä¸€å—ï¼Œå¸¦æ¥äº†ä¸€ä¸ªæ„å¤–çš„å¥½å¤„ï¼Œç”±äºåŒä¸€å±æ€§çš„æ•°æ®ç›¸ä¼¼åº¦é«˜ï¼Œå› æ­¤æ›´æ˜“å‹ç¼©ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ¯ä¸€åˆ—ä¸­å€¼åŸŸç›¸æ¯”è¡Œæ•°è¦å°çš„å¤šï¼Œå¯ä»¥ç”¨&lt;strong&gt;ä½å›¾ç¼–ç ï¼ˆ &lt;em&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Bitmap_index&#34; title=&#34;bitmap encoding&#34;&gt;bitmap encoding&lt;/a&gt;&lt;/em&gt; ï¼‰&lt;/strong&gt;ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œé›¶å”®å•†å¯èƒ½æœ‰æ•°åäº¿çš„é”€å”®äº¤æ˜“ï¼Œä½†åªæœ‰ 100,000 ä¸ªä¸åŒçš„äº§å“ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://neteric.github.io/images/ch03-fig11.png&#34; alt=&#34;ddia-3-11-compress.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾ä¸­ï¼Œæ˜¯ä¸€ä¸ªåˆ—åˆ†ç‰‡ä¸­çš„æ•°æ®ï¼Œå¯ä»¥çœ‹å‡ºåªæœ‰ {29, 30, 31, 68, 69, 74} å…­ä¸ªç¦»æ•£å€¼ã€‚é’ˆå¯¹æ¯ä¸ªå€¼å‡ºç°çš„ä½ç½®ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª bit array æ¥è¡¨ç¤ºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;bit map ä¸‹æ ‡å¯¹åº”åˆ—çš„ä¸‹æ ‡&lt;/li&gt;
&lt;li&gt;å€¼ä¸º 0 åˆ™è¡¨ç¤ºè¯¥ä¸‹æ ‡æ²¡æœ‰å‡ºç°è¯¥å€¼&lt;/li&gt;
&lt;li&gt;å€¼ä¸º 1 åˆ™è¡¨ç¤ºè¯¥ä¸‹æ ‡å‡ºç°äº†è¯¥å€¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœ bit array æ˜¯ç¨€ç–çš„ï¼Œå³å¤§é‡çš„éƒ½æ˜¯ 0ï¼Œåªè¦å°‘é‡çš„ 1ã€‚å…¶å®è¿˜å¯ä»¥ä½¿ç”¨ &lt;strong&gt;&lt;a href=&#34;https://zh.wikipedia.org/zh/%E6%B8%B8%E7%A8%8B%E7%BC%96%E7%A0%81&#34; title=&#34;æ¸¸ç¨‹ç¼–ç &#34;&gt;æ¸¸ç¨‹ç¼–ç &lt;/a&gt;ï¼ˆRLEï¼Œ Run-length encodingï¼‰&lt;/strong&gt; è¿›ä¸€æ­¥å‹ç¼©ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å°†è¿ç»­çš„ 0 å’Œ 1ï¼Œæ”¹å†™æˆ &lt;code&gt;æ•°é‡+å€¼&lt;/code&gt;ï¼Œæ¯”å¦‚ &lt;code&gt;product_sk = 29&lt;/code&gt; æ˜¯ &lt;code&gt;9 ä¸ª 0ï¼Œ1 ä¸ª 1ï¼Œ8 ä¸ª 0&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ä¸€ä¸ªå°æŠ€å·§ï¼Œå°†ä¿¡æ¯è¿›ä¸€æ­¥å‹ç¼©ã€‚æ¯”å¦‚å°†åŒå€¼é¡¹åˆå¹¶åï¼Œè‚¯å®šæ˜¯ 0 1 äº¤é”™å‡ºç°ï¼Œå›ºå®šç¬¬ä¸€ä¸ªå€¼ä¸º 0ï¼Œåˆ™äº¤é”™å‡ºç°çš„ 0 å’Œ 1 çš„å€¼ä¹Ÿä¸ç”¨å†™äº†ã€‚åˆ™ &lt;code&gt;product_sk = 29&lt;/code&gt;  ç¼–ç å˜æˆ &lt;code&gt;9ï¼Œ1ï¼Œ8&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç”±äºæˆ‘ä»¬çŸ¥é“ bit array é•¿åº¦ï¼Œåˆ™æœ€åä¸€ä¸ªæ•°å­—ä¹Ÿå¯ä»¥çœæ‰ï¼Œå› ä¸ºå®ƒå¯ä»¥é€šè¿‡ &lt;code&gt;array len - sum(other lens)&lt;/code&gt; å¾—åˆ°ï¼Œåˆ™ &lt;code&gt;product_sk = 29&lt;/code&gt;  çš„ç¼–ç æœ€åå˜æˆï¼š&lt;code&gt;9ï¼Œ1&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½å›¾ç´¢å¼•å¾ˆé€‚åˆåº”å¯¹æŸ¥è¯¢ä¸­çš„é€»è¾‘è¿ç®—æ¡ä»¶ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;WHERE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;product_sk&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;IN&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;ï¼ˆ&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;ï¼Œ&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;68&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;ï¼Œ&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;69&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¯ä»¥è½¬æ¢ä¸º &lt;code&gt;product_sk = 30&lt;/code&gt;ã€&lt;code&gt;product_sk = 68&lt;/code&gt;å’ŒÂ &lt;code&gt;product_sk = 69&lt;/code&gt;è¿™ä¸‰ä¸ª bit array æŒ‰ä½æˆ–ï¼ˆORï¼‰ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;WHERE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;product_sk&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;31&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;AND&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;store_sk&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¯ä»¥è½¬æ¢ä¸º &lt;code&gt;product_sk = 31&lt;/code&gt;å’ŒÂ &lt;code&gt;store_sk = 3&lt;/code&gt;çš„ bit array çš„æŒ‰ä½ä¸ï¼Œå°±å¯ä»¥å¾—åˆ°æ‰€æœ‰éœ€è¦çš„ä½ç½®ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å†…å­˜å¸¦å®½å’Œå‘é‡åŒ–å¤„ç†&#34;&gt;å†…å­˜å¸¦å®½å’Œå‘é‡åŒ–å¤„ç†&lt;/h4&gt;
&lt;p&gt;æ•°ä»“çš„è¶…å¤§è§„æ¨¡æ•°æ®é‡å¸¦æ¥äº†ä»¥ä¸‹ç“¶é¢ˆï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å†…å­˜å¤„ç†å¸¦å®½&lt;/li&gt;
&lt;li&gt;CPU åˆ†æ”¯é¢„æµ‹é”™è¯¯å’Œ&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E6%B5%81%E6%B0%B4%E7%BA%BF%E5%81%9C%E9%A1%BF&#34; title=&#34;æµæ°´çº¿åœé¡¿&#34;&gt;æµæ°´çº¿åœé¡¿&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…³äºå†…å­˜çš„ç“¶é¢ˆå¯å·²é€šè¿‡å‰è¿°çš„æ•°æ®å‹ç¼©æ¥ç¼“è§£ã€‚å¯¹äº CPU çš„ç“¶é¢ˆå¯ä»¥ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ—å¼å­˜å‚¨å’Œå‹ç¼©å¯ä»¥è®©æ•°æ®å°½å¯èƒ½å¤šåœ°ç¼“å­˜åœ¨ L1 ä¸­ï¼Œç»“åˆä½å›¾å­˜å‚¨è¿›è¡Œå¿«é€Ÿå¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ SIMD ç”¨æ›´å°‘çš„æ—¶é’Ÿå‘¨æœŸå¤„ç†æ›´å¤šçš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;åˆ—å¼å­˜å‚¨çš„æ’åº&#34;&gt;åˆ—å¼å­˜å‚¨çš„æ’åº&lt;/h4&gt;
&lt;p&gt;ç”±äºæ•°ä»“æŸ¥è¯¢å¤šé›†ä¸­äºèšåˆç®—å­ï¼ˆæ¯”å¦‚ sumï¼Œavgï¼Œminï¼Œmaxï¼‰ï¼Œåˆ—å¼å­˜å‚¨ä¸­çš„å­˜å‚¨é¡ºåºç›¸å¯¹ä¸é‡è¦ã€‚ä½†ä¹Ÿå…ä¸äº†éœ€è¦å¯¹æŸäº›åˆ—åˆ©ç”¨æ¡ä»¶è¿›è¡Œç­›é€‰ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯ä»¥å¦‚ LSM-Tree ä¸€æ ·ï¼Œå¯¹æ‰€æœ‰è¡ŒæŒ‰æŸä¸€åˆ—è¿›è¡Œæ’åºåå­˜å‚¨ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼Œä¸å¯èƒ½åŒæ—¶å¯¹å¤šåˆ—è¿›è¡Œæ’åºã€‚å› ä¸ºæˆ‘ä»¬éœ€è¦ç»´æŠ¤å¤šåˆ—é—´çš„ä¸‹æ ‡é—´çš„å¯¹åº”å…³ç³»ï¼Œæ‰å¯èƒ½æŒ‰è¡Œå–æ•°æ®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŒæ—¶ï¼Œæ’åºåçš„é‚£ä¸€åˆ—ï¼Œå‹ç¼©æ•ˆæœä¼šæ›´å¥½ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä¸åŒå‰¯æœ¬ä¸åŒæ’åº&#34;&gt;ä¸åŒå‰¯æœ¬ï¼Œä¸åŒæ’åº&lt;/h4&gt;
&lt;p&gt;åœ¨åˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆæ•°ä»“è¿™ä¹ˆå¤§ï¼Œé€šå¸¸æ˜¯åˆ†å¸ƒå¼çš„ï¼‰ä¸­ï¼ŒåŒä¸€ä»½æ•°æ®æˆ‘ä»¬ä¼šå­˜å‚¨å¤šä»½ã€‚å¯¹äºæ¯ä¸€ä»½æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ä¸åŒåˆ—æœ‰åºå­˜å‚¨ã€‚è¿™æ ·ï¼Œé’ˆå¯¹ä¸åŒçš„æŸ¥è¯¢éœ€æ±‚ï¼Œä¾¿å¯ä»¥è·¯ç”±åˆ°ä¸åŒçš„å‰¯æœ¬ä¸Šåšå¤„ç†ã€‚å½“ç„¶ï¼Œè¿™æ ·ä¹Ÿæœ€å¤šåªèƒ½å»ºç«‹å‰¯æœ¬æ•°ï¼ˆé€šå¸¸æ˜¯ 3 ä¸ªå·¦å³ï¼‰åˆ—ç´¢å¼•ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸€æƒ³æ³•ç”± C-Store å¼•å…¥ï¼Œå¹¶ä¸”ä¸ºå•†ä¸šæ•°æ®ä»“åº“ Vertica é‡‡ç”¨ã€‚&lt;/p&gt;
&lt;h4 id=&#34;åˆ—å¼å­˜å‚¨çš„å†™å…¥&#34;&gt;åˆ—å¼å­˜å‚¨çš„å†™å…¥&lt;/h4&gt;
&lt;p&gt;ä¸Šè¿°é’ˆå¯¹æ•°ä»“çš„ä¼˜åŒ–ï¼ˆåˆ—å¼å­˜å‚¨ã€æ•°æ®å‹ç¼©å’ŒæŒ‰åˆ—æ’åºï¼‰éƒ½æ˜¯ä¸ºäº†è§£å†³æ•°ä»“ä¸­å¸¸è§çš„è¯»å†™è´Ÿè½½ï¼Œè¯»å¤šå†™å°‘ï¼Œä¸”è¯»å–éƒ½æ˜¯è¶…å¤§è§„æ¨¡çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘ä»¬é’ˆå¯¹è¯»åšäº†ä¼˜åŒ–ï¼Œå°±è®©å†™å…¥å˜å¾—ç›¸å¯¹å›°éš¾ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¯”å¦‚ B æ ‘çš„&lt;strong&gt;åŸåœ°æ›´æ–°æµ&lt;/strong&gt;æ˜¯ä¸å¤ªè¡Œçš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè¦åœ¨ä¸­é—´æŸè¡Œæ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œ&lt;strong&gt;çºµå‘&lt;/strong&gt;æ¥è¯´ï¼Œä¼šå½±å“æ‰€æœ‰çš„åˆ—æ–‡ä»¶ï¼ˆå¦‚æœä¸åš segment çš„è¯ï¼‰ï¼›ä¸ºäº†ä¿è¯å¤šåˆ—é—´æŒ‰ä¸‹æ ‡å¯¹åº”ï¼Œ&lt;strong&gt;æ¨ªå‘&lt;/strong&gt;æ¥è¯´ï¼Œåˆå¾—æ›´æ–°è¯¥è¡Œä¸åŒåˆ—çš„æ‰€æœ‰åˆ—æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€å¹¸æˆ‘ä»¬æœ‰ LSM-Tree çš„è¿½åŠ æµã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å°†æ–°å†™å…¥çš„æ•°æ®åœ¨&lt;strong&gt;å†…å­˜&lt;/strong&gt;ä¸­ Batch å¥½ï¼ŒæŒ‰è¡ŒæŒ‰åˆ—ï¼Œé€‰ä»€ä¹ˆæ•°æ®ç»“æ„å¯ä»¥çœ‹éœ€æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åè¾¾åˆ°ä¸€å®šé˜ˆå€¼åï¼Œæ‰¹é‡åˆ·åˆ°&lt;strong&gt;å¤–å­˜&lt;/strong&gt;ï¼Œå¹¶ä¸è€æ•°æ®åˆå¹¶ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ•°ä»“ Vertica å°±æ˜¯è¿™ä¹ˆåšçš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;åœ¨å­˜å‚¨å¼•æ“é¢†åŸŸï¼Œæ²¡æœ‰çœŸæ­£çš„é“¶å¼¹ï¼Œçºµè§‚å„ç§ç°åœ¨çš„å­˜å‚¨å¼•æ“çš„å­˜å‚¨è§£å†³æ–¹æ¡ˆï¼Œéƒ½æ˜¯åœ¨è¯»å’Œå†™ä¹‹é—´åšæƒè¡¡ï¼ˆtrade offï¼‰ã€‚æ°å½“çš„&lt;strong&gt;å­˜å‚¨æ ¼å¼&lt;/strong&gt;èƒ½åŠ å¿«å†™ï¼ˆæ¯”å¦‚LSM Treeï¼‰ï¼Œä½†æ˜¯ä¼šè®©è¯»å–å¾ˆæ…¢ï¼›ä¹Ÿå¯ä»¥åŠ å¿«è¯»ï¼ˆæŸ¥æ‰¾æ ‘ã€Bæ—æ ‘ï¼‰ï¼Œä½†ä¼šè®©å†™å…¥è¾ƒæ…¢ã€‚ä¸ºäº†å¼¥è¡¥è¯»æ€§èƒ½ï¼Œå¯ä»¥æ„å»ºç´¢å¼•ï¼Œä½†æ˜¯ä¼šç‰ºç‰²å†™å…¥æ€§èƒ½å’Œè€—è´¹é¢å¤–ç©ºé—´ã€‚åªæœ‰åˆç†çš„ç¡¬ç›˜å­˜å‚¨ç»“æ„å’Œå†…å­˜æ•°æ®ç»“æ„ï¼ˆç´¢å¼•ï¼‰çš„ç»“åˆï¼Œæ‰èƒ½å‘æŒ¥å‡ºç‰¹å®šçš„æ•ˆæœï¼Œè§£å†³ç‰¹å®šçš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒæ–‡çŒ®&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ã€Šæ•°æ®æ•æ„Ÿå‹åº”ç”¨è®¾è®¡ã€‹&lt;/li&gt;
&lt;li&gt;ã€ŠMySQLæŠ€æœ¯å†…å¹• InnoDBå­˜å‚¨å¼•æ“ã€‹ç¬¬äºŒç‰ˆ&lt;/li&gt;
&lt;li&gt;ã€ŠElasticSearch æƒå¨æŒ‡å—ã€‹&lt;/li&gt;
&lt;li&gt;ã€ŠLucene åŸç†ä¸æºç åˆ†æã€‹&lt;/li&gt;
&lt;li&gt;ã€Šå¤§è§„æ¨¡åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼šåŸç†è§£æä¸æ¶æ„å®æˆ˜ã€‹&lt;/li&gt;
&lt;li&gt;ã€ŠCephè®¾è®¡åŸç†ä¸å®ç°ã€‹&lt;/li&gt;
&lt;li&gt;ã€ŠCephæºç åˆ†æã€‹&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://lrita.github.io/images/posts/filesystem/Linux.Kernel.IO.Scheduler.pdf&#34;&gt;https://lrita.github.io/images/posts/filesystem/Linux.Kernel.IO.Scheduler.pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://tech.meituan.com/2017/05/19/about-desk-io.html&#34;&gt;https://tech.meituan.com/2017/05/19/about-desk-io.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://info.mrtlab.com/picdoc/Hard-disk-structure.html&#34;&gt;http://info.mrtlab.com/picdoc/Hard-disk-structure.html&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</content>
            
            
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/categories/%E5%AD%98%E5%82%A8/" term="å­˜å‚¨" label="å­˜å‚¨" />
                            
                        
                    
                
                    
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/b-tree/" term="B&#43;Tree" label="B&#43;Tree" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/lsm-tree/" term="LSM Tree" label="LSM Tree" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/log-structed/" term="Log Structed" label="Log Structed" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/linux-io/" term="Linux IO" label="Linux IO" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/disk-struct/" term="Disk Struct" label="Disk Struct" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">å…³äºè´Ÿè½½å‡è¡¡</title>
            <link rel="alternate" type="text/html" href="https://neteric.github.io/posts/about_load_balance/" />
            <id>https://neteric.github.io/posts/about_load_balance/</id>
            <updated>2022-10-02T00:06:13&#43;08:00</updated>
            <published>2020-02-29T17:22:54&#43;08:00</published>
            <author>
                    <name>neteric</name>
                    <uri>https://blog.neteric.top/</uri>
                    <email>neteric@126.com</email>
                    </author>
            <rights>[èœ€ICPå¤‡2022023345å·-1](http://beian.miit.gov.cn/)</rights><summary type="html">ä¸ºä½•éœ€è¦è´Ÿè½½å‡è¡¡ï¼Ÿ ä¸šåŠ¡åˆæœŸï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå…ˆä½¿ç”¨å•å°æœåŠ¡å™¨å¯¹å¤–æä¾›æœåŠ¡ã€‚éšç€ä¸šåŠ¡æµé‡è¶Šæ¥è¶Šå¤§ï¼Œå•å°æœåŠ¡å™¨æ— è®ºå¦‚ä½•ä¼˜åŒ–ï¼Œæ— è®ºé‡‡ç”¨å¤šå¥½çš„ç¡¬ä»¶ï¼Œæ€»ä¼šæœ‰æ€§èƒ½å¤©èŠ±æ¿ï¼Œå½“å•æœåŠ¡å™¨çš„æ€§èƒ½æ— æ³•æ»¡è¶³ä¸šåŠ¡ï¼Œè‡ªç„¶å°±æƒ³åˆ°æŠŠå¤šå°æœåŠ¡å™¨ç»„æˆé›†ç¾¤æ¥æé«˜è¯·æ±‚å¤„ç†èƒ½åŠ›ã€‚é›†ç¾¤å¿…é¡»è¦ä»¥ç»Ÿä¸€çš„å…¥å£æ–¹å¼å¯¹å¤–æä¾›æœåŠ¡ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ª æµé‡è°ƒåº¦å™¨ ï¼Œé€šè¿‡å‡è¡¡çš„ç®—æ³•å°†ç”¨æˆ·å¤§é‡çš„è¯·æ±‚å‡è¡¡åœ°åˆ†å‘åˆ°åç«¯é›†ç¾¤ä¸åŒçš„æœåŠ¡å™¨ä¸Š</summary>
            
                <content type="html">&lt;h3 id=&#34;ä¸ºä½•éœ€è¦è´Ÿè½½å‡è¡¡&#34;&gt;ä¸ºä½•éœ€è¦è´Ÿè½½å‡è¡¡ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ä¸šåŠ¡åˆæœŸï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå…ˆä½¿ç”¨å•å°æœåŠ¡å™¨å¯¹å¤–æä¾›æœåŠ¡ã€‚éšç€ä¸šåŠ¡æµé‡è¶Šæ¥è¶Šå¤§ï¼Œå•å°æœåŠ¡å™¨æ— è®ºå¦‚ä½•ä¼˜åŒ–ï¼Œæ— è®ºé‡‡ç”¨å¤šå¥½çš„ç¡¬ä»¶ï¼Œæ€»ä¼šæœ‰æ€§èƒ½å¤©èŠ±æ¿ï¼Œå½“å•æœåŠ¡å™¨çš„æ€§èƒ½æ— æ³•æ»¡è¶³ä¸šåŠ¡ï¼Œè‡ªç„¶å°±æƒ³åˆ°æŠŠå¤šå°æœåŠ¡å™¨ç»„æˆé›†ç¾¤æ¥æé«˜è¯·æ±‚å¤„ç†èƒ½åŠ›ã€‚é›†ç¾¤å¿…é¡»è¦ä»¥ç»Ÿä¸€çš„å…¥å£æ–¹å¼å¯¹å¤–æä¾›æœåŠ¡ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ª &lt;strong&gt;æµé‡è°ƒåº¦å™¨&lt;/strong&gt; ï¼Œé€šè¿‡å‡è¡¡çš„ç®—æ³•å°†ç”¨æˆ·å¤§é‡çš„è¯·æ±‚å‡è¡¡åœ°åˆ†å‘åˆ°åç«¯é›†ç¾¤ä¸åŒçš„æœåŠ¡å™¨ä¸Š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;è´Ÿè½½å¹³è¡¡&lt;/strong&gt;ï¼ˆLoad balancingï¼‰æ˜¯ä¸€ç§&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA&#34;&gt;è®¡ç®—æœº&lt;/a&gt;æŠ€æœ¯ï¼Œç”¨æ¥åœ¨å¤šä¸ªè®¡ç®—æœºï¼ˆ&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%9B%86%E7%BE%A4&#34;&gt;è®¡ç®—æœºé›†ç¾¤&lt;/a&gt;ï¼‰ã€ç½‘ç»œè¿æ¥ã€CPUã€ç£ç›˜é©±åŠ¨å™¨æˆ–å…¶ä»–èµ„æºä¸­åˆ†é…è´Ÿè½½ï¼Œä»¥è¾¾åˆ°æœ€ä¼˜åŒ–èµ„æºä½¿ç”¨ã€æœ€å¤§åŒ–ååç‡ã€æœ€å°åŒ–å“åº”æ—¶é—´ã€åŒæ—¶é¿å…è¿‡è½½çš„ç›®çš„ã€‚ ä½¿ç”¨å¸¦æœ‰è´Ÿè½½å¹³è¡¡çš„å¤šä¸ªæœåŠ¡å™¨ç»„ä»¶ï¼Œå–ä»£å•ä¸€çš„ç»„ä»¶ï¼Œå¯ä»¥é€šè¿‡&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E5%86%97%E9%A4%98&#34;&gt;å†—ä½™&lt;/a&gt;æé«˜å¯é æ€§ã€‚è´Ÿè½½å¹³è¡¡æœåŠ¡é€šå¸¸æ˜¯ç”±ä¸“ç”¨è½¯ä»¶å’Œç¡¬ä»¶æ¥å®Œæˆã€‚ ä¸»è¦ä½œç”¨æ˜¯å°†å¤§é‡ä½œä¸šåˆç†åœ°åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šè¿›è¡Œæ‰§è¡Œï¼Œç”¨äºè§£å†³äº’è”ç½‘æ¶æ„ä¸­çš„&lt;strong&gt;é«˜å¹¶å‘&lt;/strong&gt;å’Œ&lt;strong&gt;é«˜å¯ç”¨&lt;/strong&gt;çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä½¿ç”¨è´Ÿè½½å‡è¡¡å¸¦æ¥çš„å¥½å¤„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æé«˜äº†ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½&lt;/li&gt;
&lt;li&gt;æé«˜äº†ç³»ç»Ÿçš„æ‰©å±•æ€§&lt;/li&gt;
&lt;li&gt;æé«˜äº†ç³»ç»Ÿçš„å¯é æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è´Ÿè½½å‡è¡¡å™¨ä»å¹¿ä¹‰ä¸Šå¯ä»¥åˆ†ä¸º 3 ç±»ï¼šDNS å®ç°è´Ÿè½½å‡è¡¡ã€ç¡¬ä»¶è´Ÿè½½å‡è¡¡ã€è½¯ä»¶è´Ÿè½½å‡è¡¡&lt;/p&gt;
&lt;h4 id=&#34;dns-å®ç°è´Ÿè½½å‡è¡¡&#34;&gt;DNS å®ç°è´Ÿè½½å‡è¡¡&lt;/h4&gt;
&lt;p&gt;ä¸€ä¸ªåŸŸåé€šè¿‡ DNS è§£æåˆ°å¤šä¸ª IPï¼Œæ¯ä¸ª IP å¯¹åº”ä¸åŒçš„æœåŠ¡å™¨å®ä¾‹ï¼Œè¿™æ ·å°±å®Œæˆäº†æµé‡çš„è°ƒåº¦ï¼Œè™½ç„¶æ²¡æœ‰ä½¿ç”¨å¸¸è§„çš„è´Ÿè½½å‡è¡¡å™¨ï¼Œä½†ä¹Ÿçš„ç¡®å®Œæˆäº†è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ DNS å®ç°è´Ÿè½½å‡è¡¡çš„æ–¹å¼ï¼Œæœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯å®ç°ç®€å•ï¼Œæˆæœ¬ä½ï¼Œæ— éœ€è‡ªå·±å¼€å‘æˆ–ç»´æŠ¤è´Ÿè½½å‡è¡¡è®¾å¤‡ï¼Œä¸è¿‡å­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœåŠ¡å™¨æ•…éšœåˆ‡æ¢å»¶è¿Ÿå¤§ï¼ŒæœåŠ¡å™¨å‡çº§ä¸æ–¹ä¾¿&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“ DNS ä¸ç”¨æˆ·ä¹‹é—´æ˜¯å±‚å±‚çš„ç¼“å­˜ï¼Œå³ä¾¿æ˜¯åœ¨æ•…éšœå‘ç”Ÿæ—¶åŠæ—¶é€šè¿‡ DNS ä¿®æ”¹æˆ–æ‘˜é™¤æ•…éšœæœåŠ¡å™¨ï¼Œä½†ä¸­é—´ç”±äºç»è¿‡è¿è¥å•†çš„ DNS ç¼“å­˜ï¼Œä¸”ç¼“å­˜å¾ˆæœ‰å¯èƒ½ä¸éµå¾ª TTL è§„åˆ™ï¼Œå¯¼è‡´ DNS ç”Ÿæ•ˆæ—¶é—´å˜å¾—éå¸¸ç¼“æ…¢ï¼Œæœ‰æ—¶å€™ä¸€å¤©åè¿˜ä¼šæœ‰äº›è®¸çš„è¯·æ±‚æµé‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æµé‡è°ƒåº¦ä¸å‡è¡¡ï¼Œç²’åº¦å¤ªç²—&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;DNS è°ƒåº¦çš„å‡è¡¡æ€§ï¼Œå—åœ°åŒºè¿è¥å•† LocalDNS è¿”å› IP åˆ—è¡¨çš„ç­–ç•¥æœ‰å…³ç³»ï¼Œæœ‰çš„è¿è¥å•†å¹¶ä¸ä¼šè½®è¯¢è¿”å›å¤šä¸ªä¸åŒçš„ IP åœ°å€ã€‚å¦å¤–ï¼ŒæŸä¸ªè¿è¥å•† LocalDNS èƒŒåæœåŠ¡äº†å¤šå°‘ç”¨æˆ·ï¼Œè¿™ä¹Ÿä¼šæ„æˆæµé‡è°ƒåº¦ä¸å‡çš„é‡è¦å› ç´ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æµé‡åˆ†é…ç­–ç•¥æ¯”è¾ƒç®€å•ï¼Œæ”¯æŒçš„ç®—æ³•è¾ƒå°‘&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;DNS ä¸€èˆ¬åªæ”¯æŒ RR çš„è½®è¯¢æ–¹å¼ï¼Œæµé‡åˆ†é…ç­–ç•¥æ¯”è¾ƒç®€å•ï¼Œä¸æ”¯æŒæƒé‡ã€Hash ç­‰è°ƒåº¦ç®—æ³•ã€‚
DNS æ”¯æŒçš„ IP åˆ—è¡¨æœ‰é™åˆ¶ã€‚æˆ‘ä»¬çŸ¥é“ DNS ä½¿ç”¨ UDP æŠ¥æ–‡è¿›è¡Œä¿¡æ¯ä¼ é€’ï¼Œæ¯ä¸ª UDP æŠ¥æ–‡å¤§å°å—é“¾è·¯çš„ MTU é™åˆ¶ï¼Œæ‰€ä»¥æŠ¥æ–‡ä¸­å­˜å‚¨çš„ IP åœ°å€æ•°é‡ä¹Ÿæ˜¯éå¸¸æœ‰é™çš„ï¼Œé˜¿é‡Œ DNS ç³»ç»Ÿé’ˆå¯¹åŒä¸€ä¸ªåŸŸåæ”¯æŒé…ç½® 10 ä¸ªä¸åŒçš„ IP åœ°å€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€äº›å¤§å…¬å¸ä¸€èˆ¬ä¹Ÿä¼šåˆ©ç”¨ DNS æ¥å®ç°åœ°ç†çº§åˆ«çš„è´Ÿè½½å‡è¡¡ï¼Œå®ç°å°±è¿‘è®¿é—®ï¼Œæé«˜è®¿é—®é€Ÿåº¦ï¼Œè¿™ç§æ–¹å¼ä¸€èˆ¬æ˜¯å…¥å£æµé‡çš„åŸºç¡€è´Ÿè½½å‡è¡¡ï¼Œä¸‹å±‚ä¼šæœ‰æ›´ä¸“ä¸šçš„è´Ÿè½½å‡è¡¡è®¾å¤‡å®ç°çš„è´Ÿè½½æ¶æ„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;ç¡¬ä»¶è´Ÿè½½å‡è¡¡&#34;&gt;ç¡¬ä»¶è´Ÿè½½å‡è¡¡&lt;/h4&gt;
&lt;p&gt;ç¡¬ä»¶è´Ÿè½½å‡è¡¡æ˜¯é€šè¿‡ä¸“é—¨çš„ç¡¬ä»¶è®¾å¤‡æ¥å®ç°è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œç±»ä¼¼äºäº¤æ¢æœºã€è·¯ç”±å™¨ï¼Œæ˜¯ä¸€ä¸ªè´Ÿè½½å‡è¡¡ä¸“ç”¨çš„ç½‘ç»œè®¾å¤‡ã€‚ç›®å‰ä¸šç•Œå…¸å‹çš„ç¡¬ä»¶è´Ÿè½½å‡è¡¡è®¾å¤‡æœ‰ä¸¤æ¬¾ï¼šF5 å’Œ A10ã€‚è¿™ç±»è®¾å¤‡æ€§èƒ½å¼ºåŠ²ã€åŠŸèƒ½å¼ºå¤§ï¼Œä½†ä»·æ ¼éå¸¸æ˜‚è´µï¼Œä¸€èˆ¬åªæœ‰ â€œåœŸè±ªâ€ å…¬å¸æ‰ä¼šä½¿ç”¨æ­¤ç±»è®¾å¤‡ï¼Œæ™®é€šä¸šåŠ¡é‡çº§çš„å…¬å¸ä¸€èˆ¬è´Ÿæ‹…ä¸èµ·ï¼ŒäºŒæ˜¯ä¸šåŠ¡é‡æ²¡é‚£ä¹ˆå¤§ï¼Œç”¨è¿™äº›è®¾å¤‡ä¹Ÿæ˜¯æµªè´¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„ä¼˜ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½å¼ºå¤§&lt;/strong&gt;ï¼šå…¨é¢æ”¯æŒå„å±‚çº§çš„è´Ÿè½½å‡è¡¡ï¼Œæ”¯æŒå…¨é¢çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½å¼ºå¤§&lt;/strong&gt;ï¼šæ€§èƒ½è¿œè¶…å¸¸è§çš„è½¯ä»¶è´Ÿè½½å‡è¡¡å™¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¨³å®šæ€§é«˜&lt;/strong&gt;ï¼šå•†ç”¨ç¡¬ä»¶è´Ÿè½½å‡è¡¡ï¼Œç»è¿‡äº†è‰¯å¥½çš„ä¸¥æ ¼æµ‹è¯•ï¼Œç»è¿‡å¤§è§„æ¨¡ä½¿ç”¨ï¼Œç¨³å®šæ€§é«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨é˜²æŠ¤&lt;/strong&gt;ï¼šé™¤äº†å…·å¤‡è´Ÿè½½å‡è¡¡å¤–ï¼Œè¿˜å…·å¤‡é˜²ç«å¢™ã€é˜² DDoS æ”»å‡»ç­‰å®‰å…¨åŠŸèƒ½ï¼Œè²Œä¼¼è¿˜æ”¯æŒ SNAT åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„ç¼ºç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»·æ ¼æ˜‚è´µ&lt;/li&gt;
&lt;li&gt;æ‰©å±•æ€§å·®ï¼Œæ— æ³•è¿›è¡Œæ‰©å±•å’Œå®šåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒè¯•å’Œç»´æŠ¤æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦ä¸“ä¸šäººå‘˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;è½¯ä»¶è´Ÿè½½å‡è¡¡&#34;&gt;è½¯ä»¶è´Ÿè½½å‡è¡¡&lt;/h4&gt;
&lt;p&gt;è½¯ä»¶è´Ÿè½½å‡è¡¡ï¼Œå¯ä»¥åœ¨æ™®é€šçš„æœåŠ¡å™¨ä¸Šè¿è¡Œè´Ÿè½½å‡è¡¡è½¯ä»¶ï¼Œå®ç°è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚ç›®å‰å¸¸è§çš„æœ‰ Nginxã€HAproxyã€LVS&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Nginx&lt;/strong&gt; ï¼šæ˜¯ 7 å±‚è´Ÿè½½å‡è¡¡ï¼Œæ”¯æŒ HTTPã€E-mail åè®®ï¼Œè²Œä¼¼ä¹Ÿæ”¯æŒ 4 å±‚è´Ÿè½½å‡è¡¡äº†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;HAproxy&lt;/strong&gt;ï¼šHAProxyæä¾›äº†L4(TCP)å’ŒL7(HTTP)ä¸¤ç§è´Ÿè½½å‡è¡¡èƒ½åŠ›ï¼Œå…·å¤‡ä¸°å¯Œçš„åŠŸèƒ½ã€‚HAProxyçš„ç¤¾åŒºéå¸¸æ´»è·ƒï¼Œç‰ˆæœ¬æ›´æ–°å¿«é€Ÿï¼ˆæœ€æ–°ç¨³å®šç‰ˆ1.7.2äº2017/01/13æ¨å‡ºï¼‰ã€‚æœ€å…³é”®çš„æ˜¯ï¼ŒHAProxyå…·å¤‡åª²ç¾å•†ç”¨è´Ÿè½½å‡è¡¡å™¨çš„æ€§èƒ½å’Œç¨³å®šæ€§&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;LVS&lt;/strong&gt; ï¼šæ˜¯çº¯ 4 å±‚çš„è´Ÿè½½å‡è¡¡ï¼Œè¿è¡Œåœ¨å†…æ ¸æ€ï¼Œæ€§èƒ½æ˜¯è½¯ä»¶è´Ÿè½½å‡è¡¡ä¸­æœ€é«˜çš„ï¼Œå› ä¸ºæ˜¯åœ¨å››å±‚ï¼Œæ‰€ä»¥ä¹Ÿæ›´é€šç”¨ä¸€äº›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;è½¯ä»¶è´Ÿè½½å‡è¡¡çš„ä¼˜ç‚¹&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç®€å•&lt;/strong&gt;ï¼šæ— è®ºæ˜¯éƒ¨ç½²è¿˜æ˜¯ç»´æŠ¤éƒ½æ¯”è¾ƒç®€å•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¾¿å®œ&lt;/strong&gt;ï¼šä¹°ä¸ª Linux æœåŠ¡å™¨ï¼Œè£…ä¸Šè½¯ä»¶å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;çµæ´»&lt;/strong&gt;ï¼š4 å±‚å’Œ 7 å±‚è´Ÿè½½å‡è¡¡å¯ä»¥æ ¹æ®ä¸šåŠ¡è¿›è¡Œé€‰æ‹©ï¼›ä¹Ÿå¯ä»¥æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹ï¼Œæ¯”è¾ƒæ–¹ä¾¿è¿›è¡Œæ‰©å±•å’Œå®šåˆ¶åŠŸèƒ½ã€‚
æ®äº†è§£å¦‚ BAT ç­‰å¤§å‚éƒ½æ˜¯ LVS é‡åº¦ä½¿ç”¨è€…ï¼Œå°±æ˜¯å› ä¸º LVS éå¸¸å‡ºè‰²çš„æ€§èƒ½ï¼Œèƒ½ä¸ºå…¬å¸èŠ‚çœå¾ˆå¤§æˆæœ¬ï¼Œäº†è§£åˆ°å¾ˆå¤šå¤§å…¬å¸ä½¿ç”¨çš„ LVS éƒ½æ˜¯å®šåˆ¶ç‰ˆçš„ï¼Œåšè¿‡å¾ˆå¤šæ€§èƒ½æ–¹é¢çš„ä¼˜åŒ–ï¼Œæ¯”å¼€æºç‰ˆæœ¬æ€§èƒ½ä¼šé«˜å‡ºå¾ˆå¤šã€‚ç›®å‰åªæœ‰æ·˜å®å¼€æºè¿‡ä¼˜åŒ–è¿‡çš„ alibaba/LVSï¼Œæ”¯æŒ FNAT æ¨¡å¼ï¼Œä½†æ˜¯ä¹Ÿå¾ˆä¹…æ²¡æœ‰æ›´æ–°è¿‡äº†ã€‚å¦å¤–çˆ±å¥‡è‰ºå»å¹´å¼€æºå‡ºäº† DPDK ç‰ˆæœ¬çš„ LVSï¼Œåå« DPVSï¼Œæ€§èƒ½éå¸¸å¼ºæ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
</content>
            
            
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/categories/network/" term="network" label="network" />
                            
                        
                    
                
                    
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/network/" term="network" label="network" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/loadbalancer/" term="LoadBalancer" label="LoadBalancer" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/lvs/" term="LVS" label="LVS" />
                            
                        
                            
                            
                            
                                <category scheme="https://neteric.github.io/tags/nginx/" term="Nginx" label="Nginx" />
                            
                        
                    
                
            
        </entry>
    
</feed>
